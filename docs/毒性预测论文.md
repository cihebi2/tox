<!--
本报告由自动化阅读本目录PDF与 /root/private_data/dd_model 中对应代码生成。
如需我补充某篇论文的“实验设置/超参/消融/统计检验”细节，可继续追问并指定论文名。
-->

# 毒性预测论文与代码逐篇分析报告

生成时间：2026-01-15 16:23:09 +0800
更新时间：2026-01-16 08:06:27 +0800

分析范围（本地文件）：

- 论文PDF：`/root/private_data/aa_peptide/toxin/docs/*.pdf`（共 8 篇）
- 代码实现：`/root/private_data/dd_model` 中与毒性预测相关目录（共 7 个）：`ToxGIN/`、`ToxMSRC/`、`ToxiPep/`、`ToxDL2/`、`toxin/HyPepTox-Fuse/`、`pepADMET/`、`MultiToxPred/`

本报告聚焦三件事（逐篇给出）：

1) **创新点**：模型结构/特征形态/训练策略/可解释性等真正“新增”的部分  
2) **评价方式**：切分策略（CV/独立集/时间外推）、指标（AUROC/AUPRC/MCC/BACC…）、阈值与对比基线  
3) **数据来源**：正/负样本的来源数据库与过滤规则、去冗余策略（CD-HIT阈值）、样本量与分布

---

## 0. 速览对比（任务/模态/切分）

| 名称 | 任务对象 | 输入模态（核心） | 训练/验证/测试策略（论文） | 主要指标（论文） | 本地代码/数据核对 |
|---|---|---|---|---|---|
| HyPepTox-Fuse | 肽毒性（二分类） | 多PLM embedding + 传统描述符 | 5-fold CV + 独立集 + 新数据集case study | SEN/SPE/Acc/F1/MCC/auROC | 有代码与原始FASTA，样本量一致 |
| ToxiPep | 肽毒性（二分类） | 序列上下文(BiGRU+Transformer) + 原子级图(2D) | CD-HIT(0.9/0.8) 内部测试 + 外部独立集(DBAASP) | Acc/Sn/Sp/MCC/AUC | 有代码与数据划分文件，样本量一致 |
| ToxMSRC | 肽毒性（二分类） | Word2Vec(CBOW) + CNN/BiLSTM | benchmark + 2个独立集 | BACC（并报告多指标） | 有代码与FASTA/标签，样本量一致 |
| ToxGIN | 肽毒性（二分类） | 3D结构残基图 + ESM2 + AAindex | 5-fold Stratified CV（代码） | AUROC/AUPRC/Acc/F1/MCC… | 有代码与CSV（结构需另下） |
| ToxDL 2.0 | 蛋白毒性（二分类） | ESM2(进化) + 结构图(AlphaFold2) + 域向量 | 原始test(≤2021) + 时间外推独立集(≥2022) | F1/MCC/auROC/auPRC | 本地含序列/域数据；PDB仅样例 |
| ProToxin | 蛋白毒性（二分类） | 手工特征 + XGBoost | 20-fold/20-times CV + 盲测集 | Acc/MCC/F1/AUC/OPM… | 仅PDF（无本地代码） |
| MultiToxPred 1.0 | 蛋白毒素（27类多分类 + 非毒） | 序列描述符（PAAC + DPC）+ Stacking | 80/20 随机划分 + 10-fold CV；SMOTE 类平衡 | ACC/F1/Prec/SEN/AUC | 有代码与FASTA/平衡特征（负样本为随机序列） |
| ToxPre-2L | 毒性肽（二分类）+ 功能多标签 | 多视角特征 + 多视角张量学习 | 10-fold CV（8:1:1） | AUC/ACC/MCC/F1… | 仅PDF（代码在作者网站） |
| pepADMET(含MLR-GAT) | 肽ADMET平台（含多类毒性） | 图网络(RGCN/GAT) + 描述符 + 迁移/多任务 | 多次随机划分（8:1:1；部分任务0.75:0.25） | ACC/AUC/Recall/Prec/F1；回归R2/MAE/RMSE | 有代码与示例数据（但非全量） |

**关键结果（论文数值摘要；不同数据集/定义不可直接横比）**

| 工作 | 数据集/设置（论文） | 论文报告的关键指标（节选） |
|---|---|---|
| HyPepTox-Fuse | 本文独立集 | MCC 0.8143 / Acc 0.9067 / F1 0.9045 / AUC 0.9624 |
| HyPepTox-Fuse | ToxTeller independent dataset | Acc 0.8850 / MCC 0.7731 / AUC 0.9540 |
| ToxDL 2.0 | original test（pre-2022） | F1 0.878 / MCC 0.869 / auROC 0.992 / auPRC 0.891 |
| ToxDL 2.0 | independent test（post-2022） | F1 0.614 / MCC 0.610 / auROC 0.945 / auPRC 0.611 |
| ProToxin | blind test | Acc 0.906 / MCC 0.797 / F1 0.864 / AUC 0.885 |
| MultiToxPred 1.0 | Training 10-fold CV（Table 5） | Acc 0.840 / F1 0.827 / AUC 0.989 |
| MultiToxPred 1.0 | Independent test（Table 5） | Acc 0.846 / F1 0.838 / AUC 0.991 |
| ToxMSRC | independent test1 | ACC 94.05% / BACC 92.17% / AUC 0.965 / MCC 0.852 |
| ToxMSRC | independent test2 | ACC 94.16% / BACC 86.89% / AUC 0.943 / MCC 0.655 |
| ToxiPep | internal test（CD-HIT 0.9） | Acc 0.850 / MCC 0.701 |
| ToxiPep | internal test（去重后对 ToxinPred3，CD-HIT 0.9） | Acc 0.885 / MCC 0.769 |
| ToxiPep | independent（去重后，Table S6 文中一句） | Acc 0.828 / MCC 0.578 |
| ToxPre-2L | STXP 多标签（Table 1） | Acc 0.86 / HL 0.06 / AP 0.94 / CV 1.65 |
| pepADMET | six-class toxicity（Figure S8） | Acc 0.885 / AUC 0.949 |

---

## 1) HyPepTox-Fuse（J Pharm Anal 2025）

**论文信息**

- 标题：HyPepTox-Fuse: An interpretable hybrid framework for accurate peptide toxicity prediction fusing protein language model-based embeddings with conventional descriptors
- 期刊/年份：Journal of Pharmaceutical Analysis, 2025
- DOI：10.1016/j.jpha.2025.101410

**任务与输出**

- 肽毒性二分类：预测 `toxic / non-toxic`
- 强调鲁棒性、可解释性与泛化（含 case study）

**数据来源（论文明确给出）**

- 毒性肽（正样本）来自多个数据库：Conoserver、DRAMP 3.0、CAMPR3、dbAMP2.0、YADAMP、DBAASP-v3、UniProt、SwissProt
- 非毒性肽（负样本）来自 UniProt（查询：`"NOT toxin NOT toxic AND reviewed: yes"`）
- 说明：该基准数据集来自 ToxinPred3（Rathore et al.）的整理版本

**数据规模与切分（论文 + 本地核对）**

- 全数据：5,518 non-toxic + 5,518 toxic（平衡）
- 划分：80% 训练集（4,414/4,414）+ 20% 独立集（1,104/1,104）
- 本地核对（来自代码仓库原始FASTA）：  
  - `dd_model/toxin/HyPepTox-Fuse/raw_dataset/train_pos.fa` = 4414  
  - `dd_model/toxin/HyPepTox-Fuse/raw_dataset/train_neg.fa` = 4414  
  - `dd_model/toxin/HyPepTox-Fuse/raw_dataset/test_pos.fa` = 1104  
  - `dd_model/toxin/HyPepTox-Fuse/raw_dataset/test_neg.fa` = 1104  

**模型创新点（论文主张 + 代码实现对应）**

- **多PLM表征集成**：同时使用 ESM-1、ESM-2、ProtT5 的 embedding（比“单一PLM/单一特征模态”更丰富）
- **跨模态多头注意力 + Transformer 融合**：先做特征交互（Multi-head attention），再用 Transformer encoder 融合（`src/architectures.py`）
- **传统描述符的“排序 + 选择”管线**：两步法筛选 CCD（论文提到 LightGBM 排序、顺序前向选择；代码里 CCD 特征维度默认 887，并可取 top-k）
- **训练目标的组合**：监督损失 + 对比学习损失（论文描述 BCE + NTXent；代码实现为 focal/bce + NTXent，见 `src/lightning_module.py`）
- **集成推理**：5-fold 训练后对 5 个fold概率做 voting/平均（`train_hybrid.py`）

**评价方式（论文）**

- 5-fold cross-validation（训练集内）
- 独立测试集评估（20% holdout）
- 指标：SEN、SPE、Acc、F1、MCC（论文给出公式；并报告 auROC 等）
- 对比：与 ToxinPred 3.0（ML/DL 两个版本）在同数据集上的对比
- 额外：case study 验证对“新数据集”的泛化

**论文结果（模型指标，原文 Table 1/2 与正文）**

- 本文独立集（Table 1，同一 independent dataset）：HyPepTox-Fuse（MCC=0.8143，Acc=0.9067，F1=0.9045，AUC=0.9624）；最强基线 ToxinPred 3.0 (ML)（MCC=0.7788，Acc=0.8890，F1=0.8865，AUC=0.9502）；文中同时指出 CSM-Toxin 接近随机（Acc=0.5041）
- ToxTeller independent dataset（Table 2；并注明 ToxIBLT 由开源代码重训复现、ToxTeller 系列来自原论文）：  
  | Model | SEN | SPE | Acc | F1 | MCC | AUC |
  |---|---:|---:|---:|---:|---:|---:|
  | CSM-Toxin | 0.0600 | 0.9300 | 0.4950 | 0.1062 | -0.0203 | 0.3654 |
  | ToxIBLT | 0.6800 | 0.9000 | 0.7900 | 0.7640 | 0.5946 | 0.8576 |
  | ToxTeller-LR | 0.7000 | 0.9100 | 0.8050 | 0.7820 | 0.6240 | 0.8700 |
  | ToxTeller-SVM | 0.7500 | 0.9300 | 0.8400 | 0.8240 | 0.6910 | 0.9250 |
  | ToxTeller-RF | 0.7100 | 0.9600 | 0.8350 | 0.8110 | 0.6920 | 0.9220 |
  | ToxTeller-XGB | 0.7700 | 0.9400 | 0.8550 | 0.8420 | 0.7210 | 0.9300 |
  | HyPepTox-Fuse | 0.8400 | 0.9300 | 0.8850 | 0.8796 | 0.7731 | 0.9540 |
- 传统描述符 baseline（正文 3.4）：单一 CKSAAP type 2 在 5-fold CV（MCC=0.7509，Acc=0.8752，F1=0.8731，AUC=0.9380）与独立集（MCC=0.7886，Acc=0.8940，F1=0.8921，AUC=0.9507）的表现

**基准模型与评估方法简述（结合论文写法）**

- Table 1：对比 CSM-Toxin、ToxIBLT、ToxinPred 1.0/2.0/3.0 等常用毒性肽预测工具；部分基线结果来自其 web server，部分基线（如 ToxIBLT/ToxinPred1.0）引用自 ToxinPred3 论文汇报
- Table 2：对比 ToxTeller-LR/SVM/RF/XGB（四类传统机器学习基线：逻辑回归/支持向量机/随机森林/极端梯度提升）；ToxinPred3 因训练样本重叠被排除；ToxIBLT 由于 server 不可用而用开源代码重训复现

**结果补充（除指标外：统计检验/可解释/消融/案例）**

- 统计显著性：正文说明对比方法差异通过 McNemar’s test 做检验（Table 1 给出各基线的 P-value），并指出 HyPepTox-Fuse 的优势具统计显著性
- 表征可分性：用 UMAP 将 CCD、PLM embedding 及其融合特征降到 2D（Fig. 5），融合特征在训练集与独立集上对 toxic/non-toxic 的分离更清晰
- motif/残基解释：提取 Transformer Fusion 的 attention 权重并与 MEME 发现的 motif 对照（Fig. 6），attention 高权重区与 “CCSNP/CCSG/LKDV” 等 motif 高一致，用于解释“模型关注哪些位点/片段”
- 损失函数消融：去掉对比学习辅助损失 LNTXent 会导致性能下降；加入 LNTXent 在训练集与独立集上分别带来 MCC/Acc/F1 的小幅提升（训练集：MCC +0.73%、Acc +0.38%、F1 +0.39%；独立集：MCC +1.47%、Acc +1.00%、F1 +0.72%）；并在 Fig. S5 讨论 τ=0.1/0.5/1.0 中 τ=0.1 更稳定且 SEN/SPE 更均衡（τ=0.5 更偏向 non-toxic）
- 模块消融：仅用 PLM embedding 比较 w/o FIs、w/o TF 等（Fig. 7）；同时加入 FIs+TF 相对去掉两者可带来 MCC/Acc/F1 2.99%–3.60%/1.51%–1.77%/1.52%–1.61% 的提升，独立集亦同趋势（并报告 MCC 5.98%–6.70% 等全指标提升区间）
- 泛化 case study：用 ToxTeller 的训练集（2,151 non-toxic + 1,978 toxic）重新训练后在其独立集（100/100）评估（Section 3.6）；因重叠样本排除 ToxinPred3，并说明 ToxIBLT 因 server 不可用而以开源代码复训以保证公平对比
- 部署侧细节：web server 使用 5-fold 训练得到的 5 个模型做 ensemble voting（Section 3.7）

**可复现性/工程注意点（代码检查）**

- 内存：README 明确建议 ≥64GB RAM（默认把数据全部 preload 到内存）
- 特征依赖：主流程默认依赖“已抽取好的 PLM embedding 与 CCD 特征”（OneDrive 提供；或用 `inferencer.py` 在线抽取）
- 训练监控：以 MCC 作为 checkpoint 监控指标（更适合二分类不平衡/阈值敏感场景）
- 框架与超参：PyTorch Lightning（`lightning`）+ AdamW + StepLR；默认配置（`configs/config_HyPepToxFuse_Hybrid.yaml`）为 batch_size=256、epochs=100、lr=1e-4、k_fold=5、loss=focal、NTXent τ=0.1、threshold=0.5
- 损失实现：训练时把监督损失与 NTXent 做加权求和（代码中固定 0.8×supervised + 0.2×NTXent），与论文“监督+对比”的描述一致（`src/lightning_module.py`）
- 集成推理实现：`train_hybrid.py` 会加载 5 个 fold 的 `.ckpt`，同时输出 “平均概率” 与 “多数投票” 两套集成结果（写入 `test_avg_result.txt`/`test_voting_result.txt`）

---

## 2) ToxDL 2.0（CSBJ 2025，蛋白毒性，多模态 + 时间外推独立集）

**论文信息**

- 标题：ToxDL 2.0: Protein toxicity prediction using a pretrained language model and graph neural networks
- 期刊/年份：Computational and Structural Biotechnology Journal, 2025
- DOI：10.1016/j.csbj.2025.04.002

**任务与输出**

- 蛋白毒性二分类：输出毒性概率/标签

**数据来源与构建规则（论文明确给出）**

- 数据库版本：UniProt release 2024_03（2024-05-29）
- 正样本（toxic）：UniProt 查询 `(keyword: KW-0800) AND (reviewed: true)`
- 负样本（non-toxic, non-allergenic）：`NOT (keyword: KW-0800) AND NOT (keyword: KW-0020) AND (reviewed: true)`
- 清洗：去除非标准氨基酸（B/J/O/U/X/Z）、去除重复序列；用 CD-HIT 去冗余并控制同源泄漏
- 关键设计：**时间外推独立集**（post-2022）

**数据规模与切分（论文 + 本地核对）**

- 论文给出的四个数据集规模：  
  - 训练：4,900 toxic + 9,800 non-toxic  
  - 验证：78 toxic + 853 non-toxic  
  - 原始测试集（pre-2022）：112 toxic + 1,735 non-toxic  
  - 时间外推独立集（post-2022）：152 toxic + 4,710 non-toxic（2022-01-01 之后收集）
- 本地核对（FASTA头部含标签）：`dd_model/ToxDL2/data/protein_sequences/*.fasta` 与论文数量一致

**模型创新点（论文主张 + 代码实现对应）**

- **进化信息（PLM）+ 结构信息（图）联合建模**：  
  - 结构图：从（AlphaFold2预测的）结构中取 CA 原子，按残基距离阈值建边（代码：`src/dataset.py:pdb_to_graph`，默认 8Å）  
  - 残基表征：ESM2 `esm2_t33_650M` 提取 per-residue embedding 作为节点特征（代码：`src/dataset.py:pretrain_protein`）
- **域语义（domain embedding）模块**：  
  - 通过 InterProScan 得到蛋白域序列（论文给出 InterPro 数据来源），再用 skip-gram/Word2Vec 得到域向量  
  - 代码中域向量来自 `data/domain_data/*.domain`；也提供 `checkpoints/protein_domain_embeddings.model`
- **多模态融合**：GCN 得到结构图级表征，与域向量拼接，经 MLP 输出概率（`src/model.py`）
- **可解释性**：论文提到 Integrated Gradients 用于发现毒性 motif（对“为什么毒”给线索）

**评价方式（论文）**

- 指标：F1、MCC、auROC、auPRC
- 测试：同时在“原始非冗余测试集（pre-2022）”与“时间外推独立集（post-2022）”评估（更接近真实部署的分布漂移）
- 对比：与 ToxDL 等已有方法的对比

**论文结果（模型指标与基准，Table 2/3；deep methods 报告 mean±std）**

- 原始测试集（Table 2，pre-2022）：  
  | Method | F1-score | MCC | auROC | auPRC |
  |---|---:|---:|---:|---:|
  | ToxinPred2 (RF) | 0.795 | 0.790 | 0.986 | 0.805 |
  | ToxinPred 3.0 (ET) | 0.612 | 0.587 | 0.816 | 0.463 |
  | ToxinPred 3.0 (Hybrid) | 0.619 | 0.595 | 0.832 | 0.512 |
  | ToxDL (re-trained) | 0.794 (±0.018) | 0.780 (±0.019) | 0.978 (±0.002) | 0.744 (±0.032) |
  | CSM_Toxin | 0.848 | 0.842 | 0.985 | 0.886 |
  | tAMPer | 0.803 | 0.795 | 0.926 | 0.825 |
  | ToxDL 2.0 | 0.878 (±0.014) | 0.869 (±0.013) | 0.992 (±0.002) | 0.891 (±0.014) |
- 时间外推独立集（Table 3，post-2022）：  
  | Method | F1-score | MCC | auROC | auPRC |
  |---|---:|---:|---:|---:|
  | ToxinPred2 (RF) | 0.438 | 0.421 | 0.864 | 0.339 |
  | ToxinPred 3.0 (ET) | 0.422 | 0.404 | 0.822 | 0.242 |
  | ToxinPred 3.0 (Hybrid) | 0.435 | 0.415 | 0.833 | 0.258 |
  | ToxDL (re-trained) | 0.501 (±0.019) | 0.503 (±0.018) | 0.888 (±0.008) | 0.450 (±0.026) |
  | CSM_Toxin | 0.574 | 0.566 | 0.873 | 0.548 |
  | tAMPer | 0.509 | 0.496 | 0.857 | 0.445 |
  | ToxDL 2.0 | 0.614 (±0.025) | 0.610 (±0.022) | 0.945 (±0.006) | 0.611 (±0.020) |

**基准模型与评估方法简述（结合论文写法）**

- 评估方法：论文计算 F-max（阈值 0.01→1.0 扫描，取最大 F1）并同时报告 MCC/auROC/auPRC；独立集按时间切分（post-2022）用于评估分布漂移下泛化
- 基准模型：ToxinPred2（RF）、ToxinPred3（ET/Hybrid）、CSM-Toxin、tAMPer、ToxDL（re-trained，作者对旧版深度模型复训）均作为对比项

**结果补充（除指标外：类别不平衡/阈值策略/消融/解释案例）**

- 类别不平衡：作者对比 BCE vs Focal Loss；在极端不平衡的时间外推独立集（约 1:30）上，Focal Loss 使 F1 0.603→0.614、MCC 0.592→0.610、auROC 0.934→0.945、auPRC 0.602→0.611（Section 3.1）
- 阈值选择：除 auROC/auPRC 外，其余指标依赖阈值；论文报告 F-max，即在阈值 0.01→1.0 扫描下取得的最大 F1（Section 3.2；补充 Table S8/S9）
- 消融（Table 4）：domain-only/ESM-only/GCN-w-ESM-only 与 full model 的对比，显示 domain-only 在时间外推独立集上掉得最厉害（F1 0.302±0.009 vs 0.614±0.025），而结构图与 ESM2 的组合能带来更稳健提升
- 曲线对比：Fig. 4 给出时间外推独立集的 precision-recall curve，对比多方法在不平衡分布下的精确率-召回权衡
- 解释案例：用 Integrated Gradients 生成 saliency map，在蛋白 P0DQR5 上定位 34–68 aa 区间的 toxic motif（Fig. 5B），并与 InterPro/Pfam PF02819 的 domain 注释与 profile HMM logo 对齐（Fig. 5A/C）；作者指出 Cys (C) 在该域中频繁出现并对毒性得分贡献大；补充材料还给出另外 3 个蛋白的 motif 分析（Figs. S4–S6）
- 变体评估：作者指出该解释流程可用于评估特定突变对毒性预测的影响，从而辅助蛋白工程中的“去毒”设计（Discussion）

**可复现性/工程注意点（代码检查）**

- 结构依赖：完整复现需要大量 PDB（AlphaFold2/下载）；本地 `pdb_data/` 仅有少量样例文件
- 计算开销：ESM2 650M 做 per-residue embedding，单机CPU会很慢，默认 `device=cuda:0`
- 框架与训练：PyTorch + PyG（`torch_geometric`）；`train_ToxDL2.py` 使用 Adam(lr=1e-3) + StepLR(step=10,gamma=0.1)，训练 20 epochs（`parameters/test_000.py`）；损失为 `nn.BCELoss`（`train_ToxDL2.py`）
- 与论文实现差异（需注意）：论文强调 Focal Loss 与 F-max（阈值扫描）用于极不平衡独立集；但本地代码未实现 focal loss，且 `utils.py` 里 F1/MCC 默认按阈值 0.5 计算（变量名写作 Fmax，但实际是固定阈值的 F1）

---

## 3) ProToxin（Toxins 2025，特征工程 + XGBoost）

**论文信息**

- 标题：ProToxin, a Predictor of Protein Toxicity
- 期刊/年份：Toxins, 2025, 17, 489
- DOI：10.3390/toxins17100489

**任务与输出**

- 蛋白毒性二分类（toxin / non-toxin）

**数据来源与构建规则（论文明确给出）**

- 数据来源：UniProtKB（下载时间：2024-09-09）
- 正样本：KW-0800（toxic proteins）+ reviewed
- 负样本：排除 KW-0800 与 KW-0020（allergenic），reviewed
- 过滤：去除长度 <35 的序列；去除含非标准氨基酸（B/J/O/U/X/Z）等
- 不平衡处理：原始负样本远多于正样本（例：训练集含 8,412 toxins 与 246,092 non-toxins），论文用 **K-means 聚类**从负样本中选取与正样本数量一致的代表子集以构建平衡训练集

**数据规模与切分（论文）**

- 平衡训练集：16,824 proteins（8,412 toxins + 8,412 non-toxins），特征维度 2,614
- 盲测集：279 toxins + 474 non-toxins

**模型创新点（论文主张）**

- **大规模手工特征 + 系统性特征选择**：2,614 个特征经筛选降到 88
- **XGBoost 作为最终分类器**：在 RF/SVM/LightGBM/XGBoost 中选优（表格给出 20-times CV 结果）
- **综合指标与可部署性**：强调速度快、可用于大规模序列

**评价方式（论文）**

- 20-times/20-fold CV 用于算法选择与特征选择阶段
- 盲测集评估
- 指标覆盖较全：Sensitivity、Specificity、PPV/NPV、Accuracy、MCC、F1、AUC，以及 OPM（overall performance measure）等
- 对比：与 ToxinPred2 等现有预测器对比

**论文结果（模型指标与基准，Table 1/2/4）**

- 算法选择（Table 1，20-times CV，全特征 2614D）：  
  | Algorithm | Sensitivity | Specificity | Accuracy | MCC | F1 | AUC |
  |---|---:|---:|---:|---:|---:|---:|
  | LightGBM | 0.856 | 0.927 | 0.892 | 0.786 | 0.888 | 0.892 |
  | RF | 0.842 | 0.944 | 0.894 | 0.791 | 0.888 | 0.893 |
  | SVM | 0.638 | 0.738 | 0.711 | 0.426 | 0.688 | 0.711 |
  | XGBoost | 0.871 | 0.927 | 0.899 | 0.800 | 0.896 | 0.899 |
- 特征筛选后（Table 2，20-fold CV；88 selected features）：Accuracy=0.912，MCC=0.827，F1=0.910，AUC=0.912（同时给出多类特征子集对照）
- 盲测集（Table 4，blind test）：  
  | Model | Sensitivity | Specificity | Accuracy | MCC | OPM | F1 | AUC | Coverage |
  |---|---:|---:|---:|---:|---:|---:|---:|---:|
  | ProToxin | 0.806 | 0.964 | 0.906 | 0.797 | 0.728 | 0.864 | 0.885 | 1.000 |
  | XGBoost-88 | 0.821 | 0.956 | 0.906 | 0.796 | 0.728 | 0.866 | 0.888 | 1.000 |
  | ToxinPred2 | 0.695 | 0.951 | 0.857 | 0.690 | 0.608 | 0.782 | 0.823 | 1.000 |
  | ToxinPred2-hybrid | 0.806 | 0.907 | 0.870 | 0.719 | 0.639 | 0.821 | 0.857 | 1.000 |
  | ToxIBTL | 0.577 | 0.968 | 0.823 | 0.622 | 0.540 | 0.708 | 0.773 | 1.000 |
  | VISH-Pred | 0.758 | 0.985 | 0.899 | 0.789 | 0.718 | 0.850 | 0.871 | 0.976 |
  | CSM-Toxin | 0.728 | 0.989 | 0.892 | 0.774 | 0.701 | 0.834 | 0.859 | 1.000 |
  | MultiToxPred | 0.616 | 0.586 | 0.598 | 0.196 | 0.214 | 0.532 | 0.601 | 1.000 |

**基准模型与评估方法简述（结合论文写法）**

- 评估方法：先用 20-times CV 做算法筛选，再用 LightGBM→RFECV 做特征选择，最后在盲测集上做最终对比（Table 4）
- 基准模型：包含 ToxinPred2（含 hybrid 版本）、CSM-Toxin、VISH-Pred、MultiToxPred；并把肽毒性预测器 ToxIBTL 也作为对比项（论文原文说明）

**结果补充（除指标外：负样本抽样/特征选择/解释/超参）**

- 负样本构建：因 non-toxin 远多于 toxin，采用 clustering-based sampling；用 elbow method + SSE 选择 k=8（Fig. S1），再从 8 个簇中选取代表样本 8,412 条构建平衡负集，强调可覆盖罕见/少见序列而非随机抽样
- 多步特征选择：移除 16 个零方差特征；Pearson 相关性筛选（阈值 ≥0.8）删除 1,081 个特征（剩 1,517）；用 LightGBM 做 ensemble feature selection 得到 top-100；再用 RFECV 得到最优 88 个特征（Table 2）
- 解释性：用 SHAP/Shapley plot（Fig. 2）展示 88 特征对“判毒/判非毒”的贡献方向与大小；论文讨论 distribution descriptor 占比高，且 AAindex（如二级结构相关、linker propensity、pK、sequence conservation 等）在 top features 中出现
- 超参：在确定 XGBoost 后，使用 Bayesian hyperparameter optimization + cross-validation 训练最终模型，并在 blind test 上做最终评估（Section 2.3）

**复现备注**

- 本地仅有 PDF（未在 `dd_model` 发现对应代码）；论文声称“方法可自由获取”（通常为在线服务/工具包）

---

## 3a) MultiToxPred 1.0（BMC Bioinformatics 2024，多分类：27类蛋白毒素 + 非毒；堆叠集成）

**论文信息**

- 标题：MultiToxPred 1.0: a novel comprehensive tool for predicting 27 classes of protein toxins using an ensemble machine learning approach
- 期刊/年份：BMC Bioinformatics, 2024, 25:148
- DOI：10.1186/s12859-024-05748-z

**任务与输出**

- 多分类：预测 27 类“作用机制/靶点”毒素类型，并区分 non-PT（非毒）
- Web 工具：输出每类概率（0–1），支持 CSV 导出与按概率排序

**数据来源与构建规则（论文 + 本地核对）**

- 正样本：UniProt reviewed 序列，且需满足（1）至少一篇文献证明毒素活性（2）序列完整；共 27 类毒素，总计 6,023 条（论文逐类给出 sn）
- 负样本：生成 600 条不同长度的随机氨基酸序列，作为 non-PT（论文明确写 “randomly generated”）
- 平衡策略：SMOTE 过采样进行类平衡；本地 `BALANCED_DATA.zip` 验证为 28 类 × 942 = 26,376 条
- 切分：随机 80% training + 20% independent test；training 上做 10-fold CV

**特征与模型创新点（论文主张）**

- 仅用一级序列构建分子描述符：
  - PAAC（pseudo amino acid composition；λ=5, weight=0.05）
  - DPC（dipeptide composition；400 维）
- 多算法系统对比 + Stacking 集成：评估 RF/MLP/XGBoost/LightGBM/LR/NB/kNN/QDA，并以 `StackingClassifier` 将两模型输出堆叠
- 最优集成：DPC + (LightGBM + QDA) 在 CV 与 independent test 均最好（Table 5），用于部署 web app

**评价方式（论文）**

- 10-fold cross-validation（training，80%）
- independent test（20% holdout）
- 指标：ACC、F1、PPV（Precision）、TPR（Sensitivity）、ROC-AUC（多分类；论文表述为“mean performance measures”）

**论文结果（模型指标，Table 1–5）**

- 单模型（Table 1，PAAC + 10-fold CV）：RF Acc 0.760 / F1 0.753 / AUC 0.97；LightGBM Acc 0.754 / F1 0.750 / AUC 0.98；NB 最差（Acc 0.451）
- 单模型（Table 2，DPC + 10-fold CV）：QDA Acc 0.806 / F1 0.791 / AUC 0.92；MLP/LR/LightGBM Acc≈0.78–0.79 且 AUC≈0.98
- 独立测试（Table 3/4）：DPC 整体优于 PAAC；QDA 在 DPC 测试 Acc 0.814 / F1 0.802 / AUC 0.93
- 最终集成（Table 5，DPC + LightGBM+QDA，*标注为 best）：
  - Training-CV：Acc 0.840 / F1 0.827 / Prec 0.836 / Sens 0.840 / AUC 0.989
  - Testing：Acc 0.846 / F1 0.838 / Prec 0.847 / Sens 0.849 / AUC 0.991

**基准模型与评估方法简述**

- 基线：8 个传统 ML 分类器，分别在 PAAC 与 DPC 上训练并报告 CV/Testing 结果（Table 1–4）
- 集成：对候选基学习器进行堆叠组合（RF+LightGBM、MLP+LightGBM、MLP+QDA、LightGBM+QDA），以 Table 5 最优方案作为最终模型

**结果补充（除指标外：工具/可视化/局限）**

- 提供 ROC 曲线作为 Additional files（CV 与 testing 各一套）
- 提供 Web 应用：`https://www.biochemintelli.com/MultiToxPred-v1`（论文描述：输入序列、下载 CSV、按概率排序；阈值 0.5 作为提示）
- 重要局限（对你做模型很关键）：负样本为“随机序列”，与真实 non-toxin 蛋白分布差异巨大；且论文未报告 CD-HIT/cluster split，随机切分存在同源泄漏可能 → 可能高估真实泛化

**可复现性/本地代码与数据核对**

- 目录：`/root/private_data/dd_model/MultiToxPred`
- 原始序列：`Seqs/*.fasta` 共 28 个文件（27 类毒素 + `negative_600.fasta`）；文件名后缀计数与实际 FASTA 条目一致，总计 6,623 条
- 平衡特征：`BALANCED_DATA.zip` 内含：
  - `DATA_BALANCED/PAAC.csv`（26,376×26；25 个 `Desc_*` + `PRED`；28 类每类 942）
  - `DATA_BALANCED/DPC.csv`（26,376×401；400 个 `Desc_*` + `PRED`；28 类每类 942）
- 训练流程（notebook）：`workflow.ipynb` 使用 `imblearn.SMOTE` + `train_test_split(0.8/0.2; random_state=42)` + `cross_validate(cv=10)`；AUC 用 `roc_auc_score(..., multi_class='ovr')`；`StackingClassifier` 在 notebook 中主要为示例/注释状态（更像流程演示脚本）

**这份数据能不能用上？（给你做模型的结论）**

- 可用（推荐用“原始毒素序列”）：`Seqs/*.fasta` 里 27 类毒素序列本身是可复用的数据资产；如果你做**蛋白毒素多分类/机制分类**，它可作为一个“弱同源约束”的公开基准原料（但必须你自己重做去冗余与划分）
- 可用（补充肽毒性正样本）：在这 6,023 条毒素里，长度 10–50 aa 的短序列约 1,417 条（≈23.5%）；可筛出作为“外部毒肽正样本来源”之一（仍需与你现有毒肽数据去重，避免泄漏）
- 慎用 `BALANCED_DATA.zip` 作为你模型的 benchmark：该文件是 **SMOTE 后的描述符表**（不对应真实序列），且 `workflow.ipynb` 注释明确写了“先 SMOTE 再 train/test 切分”，存在评估泄漏风险；更适合“快速复现实验表格/跑通流程”，不适合作为可信 test set
- 不要把 `negative_600.fasta` 当真实 non-toxin：它是随机序列，分布与真实蛋白/肽差异很大；若你要构建 non-toxin，建议改为 UniProt/SwissProt reviewed 中按 `NOT KW-0800 AND NOT KW-0020` 等规则抽取，并做 CD-HIT/cluster-based split（同源泄漏控制）

---

## 4) ToxPre-2L（Bioinformatics 2025，两级：毒性判别 + 多功能类型）

**论文信息**

- 标题：Accurate prediction of toxicity peptide and its function using multi-view tensor learning and latent semantic learning framework
- 方法名：ToxPre-2L
- 期刊/年份：Bioinformatics, 2025
- DOI：10.1093/bioinformatics/btaf489

**任务与输出**

- Level-1：毒性肽（TXP）vs 非毒性肽（Non-TXP）二分类
- Level-2：对毒性肽进一步做多标签/多功能类型预测（更贴近“毒性肽往往兼具多种生物活性”）

**数据来源与构建规则（论文明确给出）**

- 正样本：2,345 条实验验证的 TXP（长度 10–50）
- 负样本：Swiss-Prot 中筛选（删除含关键词 “Toxic/Toxin/KW-0020/KW-0800” 的条目；长度匹配 10–50；去非标准残基；去重）
- 负样本去冗余：在 nontoxic 子集内用 CD-HIT 过滤（相似度阈值 0.9），得到 4,125 Non-TXP；随后随机抽取 2,345 构建平衡数据集
- Level-2 类别（论文给出 9 类）：TXP mono-label、ABP、ACP、AMP、AFP、CPP、APP、DDV、AVP

**方法创新点（论文主张）**

- **多视角特征 + 潜语义学习**：将不同视角特征（k-mer、PseAAC 等）用多视角张量学习建立潜在语义关联
- **多标签相关性建模**：低秩约束学习挖掘多标签之间的相关结构
- **feature-induced labels**：用于缓解多视角信息冗余（把“特征视角”转换为辅助标签/结构信号）

**评价方式（论文）**

- 10-fold cross-validation，并将数据“粗分”为 8:1:1（train/val/test）
- 指标：AUC、ACC、MCC、F1 等（论文叙述中给出提升区间）
- 对比：与既有毒性肽预测工具对比（含 ToxinPred 系列等）

**论文结果（模型指标，Table 1/2/3 与正文）**

- Level-1（TXP vs Non-TXP，benchmark dataset S）：论文 Fig. 2 给出 ACC/AUC 对比曲线；正文只给出相对提升区间（AUC/ACC 提升 11.33%–22.65%，MCC/F1 提升 0.11–0.58），具体绝对数值主要在图与补充材料
- Level-2（多标签功能类型，benchmark dataset STXP；Table 1，10-fold CV）：  
  | Method | Acc (↑) | HL (↓) | AP (↑) | CV (↓) |
  |---|---:|---:|---:|---:|
  | MIML-KNN | 0.77 | 0.08 | 0.98 | 2.40 |
  | MIML-RBF | 0.80 | 0.07 | 0.90 | 2.05 |
  | ML-KNN | 0.81 | 0.07 | 0.98 | 2.03 |
  | RankSVM | 0.58 | 0.12 | 0.94 | 1.70 |
  | LIFT | 0.77 | 0.08 | 0.98 | 2.38 |
  | ETFC | 0.62 | 0.09 | 0.71 | 2.64 |
  | IMFP | 0.60 | 0.10 | 0.70 | 2.62 |
  | TPpred-LE | 0.55 | 0.09 | 0.68 | 2.56 |
  | TPpred-SC | 0.57 | 0.10 | 0.71 | 2.60 |
  | ToxPre-2L | 0.86 | 0.06 | 0.94 | 1.65 |
- 计算耗时（Table 2/3，单位秒）：  
  - dataset S：ToxinPred2=11.76，ToxDL=72.10，ToxIBTL=1.46，ToxPre-2L=1.15  
  - dataset STXP：ToxPre-2L=0.02（其余方法见 Table 3，如 TPpred-SC=19.76）

**基准模型与评估方法简述（结合论文写法）**

- 评估方法：10-fold CV，且按 8:1:1 划分 train/val/test；Level-2 同时报告分类指标（Acc/HL）与排序指标（AP/CV）
- 基准模型：Level-2 对比 MIML/ML-KNN、RankSVM、LIFT 等经典多标签方法，以及 ETFC/IMFP/TPpred-* 等近期多肽功能预测方法

**结果补充（除指标外：潜语义/可视化解释/敏感性/效率）**

- 潜语义特征（MLSI）有效性：将 MLSI 与 PCA/MDDM/MDS 等降维/特征选择方法在维度 5–25（步长 5）上比较，10-fold CV 下 MLSI 在 dim=10 达到最优且更稳定；对比方法在不同维度波动更大（Fig. 3）
- 表征可解释可视化：对各视角原始特征、线性拼接特征、以及 MVTL 构建的共享 latent feature 做 t-SNE（Fig. 4），latent feature 对 TXP vs Non-TXP 分离更清晰，用于支撑“潜语义更可分”的主张
- 超参敏感性：对 λ1/λ2（Level-1）与 λ1/λ2/λ3（Level-2）做 grid search，范围 10^-6–10^1，并在 Fig. 5 展示 ACC 随组合变化，用于给出正则强度的“稳定区间”
- 计算复杂度与时间：除 Tables 2/3 的时间对比外，论文还给出主要计算步骤的复杂度推导，解释为何相较深度模型（如 ToxDL）在该任务上更高效

**复现备注**

- 论文给出代码与数据入口：`http://bliulab.net/ToxPre-2L`（本地未缓存其代码）

---

## 5) ToxMSRC（多尺度CNN + BiLSTM + 残差；不平衡处理突出）

**论文信息**

- 标题：An innovative peptide toxicity prediction model based on multi-scale convolutional neural network and residual connection
- 方法名：ToxMSRC
- DOI（数据/代码归档）：10.5281/zenodo.15668530

**任务与输出**

- 肽毒性二分类（toxic / non-toxic）

**数据来源与构建规则（论文明确给出）**

- 正样本来源：合并 CSM-Toxin、ToxinPred2、ATSE 等数据源（并去除长度>50的序列）
- 负样本来源：UniProt 中用关键词筛选非毒/非过敏：`NOT KW-0800 AND NOT KW-0020 AND reviews: true`（并过滤非标准氨基酸、长度>50）
- 融合后处理：与三来源负样本合并、删除冲突标签样本
- 去冗余：CD-HIT 相似度阈值 0.9，得到 2,138 positive 与 5,375 negative
- 切分：85% benchmark + 15% independent test1；并额外引入 independent test2

**数据规模与切分（论文 + 本地核对）**

- 训练（benchmark）最终规模：1,818 positive + 4,569 negative
- independent test1：320 positive + 806 negative
- independent test2：46 positive + 536 negative
- 本地核对（FASTA计数）：  
  - `dd_model/ToxMSRC/Raw data/train_data.fasta` = 6,387（=1,818+4,569）  
  - `dd_model/ToxMSRC/Raw data/test1.fasta` = 1,126（=320+806）  
  - `dd_model/ToxMSRC/Raw data/test2.fasta` = 582（=46+536）

**模型创新点（论文主张 + 代码实现对应）**

- **序列表示**：用 Word2Vec 的 CBOW 将氨基酸片段/序列映射到向量空间（代码中输入 shape≈(49,96)，见 `model.py`）
- **不平衡处理**：对正样本使用 SMOTE 合成过采样（论文中 1,818→3,636；代码 `smote.py`）
- **多尺度CNN**：并行卷积核（3/5/7）抽取不同感受野特征（`model.py`）
- **时序建模 + 残差**：BiLSTM 后与卷积输出做 Add 残差连接，减轻过拟合、增强泛化（`model.py`）

**评价方式（论文 + 代码检查）**

- 论文强调 BACC（Balanced Accuracy）：independent test1=92.17%，test2=86.89%
- 同时报告 AUC、ACC、Sn、Sp、MCC 等（论文与脚本均计算）
- 代码训练：8-fold KFold（在 SMOTE 后的训练集上），并在固定测试集上评估（`train.py`）

**论文结果（模型指标与基准，Table 3/4/5）**

- 与现有方法对比（Table 3）：  
  - independent test1：  
    | Method | ACC (%) | BACC (%) | AUC | Sn (%) | Sp (%) | MCC |
    |---|---:|---:|---:|---:|---:|---:|
    | CSM-Toxin | 66.69 | 47.81 | 0.400 | 4.06 | 91.56 | -0.076 |
    | ToxinPred2 | 50.54 | 64.22 | 0.874 | 95.94 | 32.51 | 0.299 |
    | ToxIBTL | 91.56 | 91.56 | 0.916 | 91.56 | 91.56 | 0.803 |
    | CAPTP | 92.01 | 91.59 | 0.959 | 90.63 | 92.56 | 0.811 |
    | ToxMSRC | 94.05 | 92.17 | 0.965 | 87.81 | 96.53 | 0.852 |
  - independent test2：  
    | Method | ACC (%) | BACC (%) | AUC | Sn (%) | Sp (%) | MCC |
    |---|---:|---:|---:|---:|---:|---:|
    | ToxIBTL | 87.80 | 78.47 | 0.785 | 67.39 | 89.55 | 0.431 |
    | CAPTP | 90.55 | 82.95 | 0.901 | 73.91 | 91.98 | 0.525 |
    | ToxMSRC | 94.16 | 86.89 | 0.943 | 78.26 | 95.52 | 0.655 |
- 不平衡处理对照（Table 5）：GAN vs SMOTE（BACC 为例）：benchmark 98.72→98.93；independent test1 88.78→92.17；independent test2 80.34→86.89（均为 SMOTE 更优）

**基准模型与评估方法简述（结合论文写法）**

- 评估方法：benchmark（训练）+ 两个独立测试集；核心指标强调 BACC，并同时报告 AUC/Sn/Sp/MCC
- 基准模型（论文背景描述 + Table 3 对比项）：  
  - CSM-Toxin：使用 protein pre-training 表征做毒性预测的模型（论文背景介绍）  
  - ToxinPred2：经典毒性预测工具（论文以其作为对比项）  
  - ToxIBTL：以 BLOSUM62 预训练 + CNN/BiGRU，并结合图特征/AAC/DPC 等特征的模型（论文背景介绍）  
  - CAPTP：CNN + Transformer/self-attention，并引入 contrastive loss 的深度模型（论文背景介绍）

**结果补充（除指标外：数据分析/架构探索/统计检验/解释）**

- 数据分析：Fig. 3A 比较各数据集长度分布，benchmark 的 toxic 多在 25–40 aa，non-toxic 更均匀；independent test2 的 toxic 更偏短，作者据此解释不同卷积核大小对 Sn 的影响
- 统计显著性：在 independent test1 用 Wilcoxon signed rank test + Friedman test 检验模型差异（P-values：0.03125/0.15625/0.03125/0.03125；overall P=0.0118）；在 independent test2 两个对比模型的 P-values 均 0.03125，overall P=0.0174（正文 Section 3.1）
- 表征可分性：PCA 与 t-SNE 可视化训练前后（Fig. 3C），展示模型学习后 toxic/non-toxic 更可分，支撑“特征提取提升可分性”的结论
- 交叉验证稳定性：Fig. 3B 给出 2–10-fold CV 结果曲线与平均值 0.9546，并与 CAPTP 的 5-fold 结果 0.9252 作对照
- 架构探索（Section 3.2）：  
  - word2vec “word” 长度：比较用 3/4 个氨基酸作为词的效果；随着 word 长度增加各指标下降，最终选择 2-mer（Fig. 4A/B）  
  - 不平衡处理：对比不做平衡/加倍/SMOTE 平衡等（Table 4）；并与 GAN 生成样本对比（Table 5），SMOTE 在 BACC 上领先 >2%  
  - 多尺度卷积：单核与不同组合比较，3+5+7 优于两两组合与单核（Fig. 5A–F），并解释短序列更适合小核  
  - 融合方式：在 multi-scale 输出融合上，element-wise addition 优于 matrix splicing，独立集 Acc 提升 4.97%/6.53%（Fig. 5G）  
  - residual connection：训练期差异不大，但在两独立集上显著更好，作者认为可缓解过拟合（Fig. 4C/D）
- 序列特征解释：用 in silico mutagenesis (ISM) 分析位置/残基贡献（Section 3.4）：G/C 在 toxic 更频繁，C 几乎各位置最高；在 independent test2 的 46 条 toxic 上对 1–11 位做 20-aa 全替换（得到 10,120 条序列）并统计预测，展示首位 M 会导致更多 non-toxic 预测等模式

**可复现性/工程注意点（代码检查）**

- 数据特征：仓库里提供了示例 `X.rar`/`word2vec_model`，完整复现实验需要按其 notebook 生成一致的 `X.npz`
- 指标实现细节：部分脚本对 AUPR/某些指标使用了“硬分类标签”而非“概率”（如 `test.py` 中 AUPR 的输入），若你复现实验建议统一用概率计算 AUC/AUPRC
- 框架与训练：Keras/TensorFlow；`train.py` 使用 8-fold KFold（shuffle=True），Adam(lr=1e-4) + categorical_crossentropy，epochs=100、batch_size=32，并用 EarlyStopping(patience=20, monitor=val_accuracy) 与 ModelCheckpoint 保存最优权重

---

## 6) ToxiPep（CSBJ 2025：序列上下文 + 原子级图 + cross-attention 融合）

**论文信息**

- 标题：ToxiPep: Peptide toxicity prediction via fusion of context-aware representation and atomic-level graph
- 期刊/年份：Computational and Structural Biotechnology Journal, 2025
- DOI：10.1016/j.csbj.2025.05.039

**任务与输出**

- 肽毒性二分类
- 论文同时强调可解释性（关键氨基酸/结构特征）与 web server

**数据来源与构建规则（论文明确给出）**

- 毒性肽：在常用毒性肽数据基础上，补充来自 DRAMP4.0 与 dbAMP3.0 的 reviewed toxic peptides
- 非毒性肽：  
  - UniProt 查询：`NOT toxin NOT toxic AND reviewed: yes`  
  - SwissProt 查询：`NOT KW-0800 AND NOT KW-0020`
- 去冗余：CD-HIT 两个阈值（0.9 与 0.8）  
  - 0.9：与既有基准可比  
  - 0.8：更严格，测试低同源泛化
- 独立集（外部）：DBAASP 中 479 条具有“实验测得溶血活性”的毒性肽（按既定溶血阈值标毒）；负样本仍按 reviewed UniProt/SwissProt 策略构建，并强调避免数据泄漏

**数据规模与切分（论文 + 本地核对）**

- 内部数据（表格给出）：  
  - CD-HIT 0.9：训练 3,528/3,528；测试 883/883（toxic/non-toxic）  
  - CD-HIT 0.8：训练 2,772/2,772；测试 694/694
- 外部独立集：479 toxic（DBAASP 溶血）+ 479 non-toxic（论文描述为配对构建）
- 本地核对（来自 `dd_model/ToxiPep/Dataset/`）：  
  - `Dataset/0.9/train.txt` = 7,056（3,528 pos + 3,528 neg）  
  - `Dataset/0.9/test.txt` = 1,766（883/883）  
  - `Dataset/0.8/train.txt` = 5,544（2,772/2,772）  
  - `Dataset/0.8/test.txt` = 1,388（694/694）  
  - `Dataset/Independent set/independent test set.txt` = 958（479/479）

**模型创新点（论文主张 + 代码实现对应）**

- **双分支表征**：  
  - 序列分支：Embedding + BiGRU + Transformer blocks（捕获局部/全局依赖）  
  - 结构/化学分支：将氨基酸映射为原子图特征张量，用 multi-scale CNN 做特征抽取（代码：`Code/atom_feature.py` + `Code/model.py:Structural`）
- **cross-attention 融合**：用 cross-attention 对齐并融合两类表征，再分类（`Code/model.py:CrossAttention/ToxiPep_Model`）
- **对“泛化”的显式设计**：通过更严格的 CD-HIT=0.8、以及外部实验独立集（DBAASP溶血）评估

**评价方式（论文 + 代码检查）**

- 指标：Accuracy、Sensitivity、Specificity、MCC、AUC（论文表述与代码 `evalution.py` 一致）
- 对比：ToxinPred2、CSM-Toxin、PepNet、ToxinPred3 等；并与多种深度/传统模型对比

**论文结果（模型指标与基准，Table 2/3 + 正文）**

- 内部测试集（Table 2）：  
  - CD-HIT 0.9：  
    | Method | Accuracy | Sensitivity | Specificity | MCC |
    |---|---:|---:|---:|---:|
    | ToxinPred2 (RF) | 0.596 | 0.974 | 0.217 | 0.293 |
    | ToxinPred2 (Hybrid) | 0.619 | 0.975 | 0.264 | 0.340 |
    | CSM-Toxin | 0.506 | 0.062 | 0.949 | 0.025 |
    | PepNet | 0.794 | 0.680 | 0.909 | 0.605 |
    | ToxiPep | 0.850 | 0.827 | 0.873 | 0.701 |
  - CD-HIT 0.8：  
    | Method | Accuracy | Sensitivity | Specificity | MCC |
    |---|---:|---:|---:|---:|
    | ToxinPred2 (RF) | 0.598 | 0.977 | 0.219 | 0.300 |
    | ToxinPred2 (Hybrid) | 0.625 | 0.980 | 0.269 | 0.354 |
    | CSM-Toxin | 0.499 | 0.048 | 0.950 | -0.007 |
    | PepNet | 0.792 | 0.684 | 0.899 | 0.598 |
    | ToxiPep | 0.840 | 0.826 | 0.854 | 0.680 |
- 与 ToxinPred3 的公平对比（Table 3；先移除与 ToxinPred3 训练集重叠样本）：  
  - CD-HIT 0.9：ToxiPep（Acc=0.885，Sn=0.879，Sp=0.890，MCC=0.769） vs ToxinPred3(ML)（Acc=0.827，MCC=0.654）/ToxinPred3(Hybrid)（Acc=0.750，MCC=0.532）  
  - CD-HIT 0.8：ToxiPep（Acc=0.850，Sn=0.854，Sp=0.847，MCC=0.701） vs ToxinPred3(ML)（Acc=0.817，MCC=0.635）/ToxinPred3(Hybrid)（Acc=0.708，MCC=0.445）
- 外部独立集（正文引用 Table S6 的一句话结果）：移除与 ToxinPred3 训练集重叠后，ToxiPep 在独立集上最高可达 Acc=0.828、MCC=0.578

**基准模型与评估方法简述（结合论文写法）**

- 评估方法：内部测试集分别在 CD-HIT=0.9/0.8 下评估；并做 paired t-test 与 Wilcoxon 检验（Table 2/3 的 P 值列）
- 基准模型（Table 2/3 对比项）：  
  - ToxinPred2：传统机器学习毒性预测器（论文以 RF 与 Hybrid 两版本对比）  
  - CSM-Toxin：已有毒性预测工具（Table 2 对比项）  
  - PepNet：深度学习肽毒性预测模型（Table 2 对比项）  
  - ToxinPred3：集成学习毒性预测器（论文强调需去除训练集重叠样本后再比较）

**结果补充（除指标外：统计分析/消融/表征空间/解释/部署）**

- 组成统计：Fig. 2 用 Wilcoxon rank-sum + Bonferroni 校正比较 AAC；D/H/K/N/S 在两类间差异不显著（corrected p>0.05），C 在 toxic 中最显著富集（−log10 p>280）；L/V/I 等疏水残基在 non-toxic 更高
- 多类基线面板：Fig. 3 将基线分为 ML（手工特征 + RF/ET/GB/AdaBoost/KNN 等）、DL（one-hot + GRU/LSTM/CNN/MLP）、PLM（ESM/ProtBERT）三组，强调 ToxiPep 在 MCC/AUC 等更均衡；KNN 仅在 Sn 略高
- 显著性检验：对与各基线的差异做 paired t-test 与 Wilcoxon test，作者报告所有比较 p<0.001（Section 3.2）
- 消融（Fig. 4 + Table S7）：Transformer（Acc 0.788/MCC 0.577）→加 GRU（Acc 0.816/MCC 0.632）→加入结构分支与融合进一步提升；拼接融合（Acc 0.837/MCC 0.674/AUC 0.912）与 late fusion（Acc 0.830/MCC 0.660/AUC 0.904）均不及 cross-attention 的 ToxiPep（Acc 0.850/Sn 0.827/Sp 0.873/MCC 0.701/AUC 0.919）
- 表征空间：UMAP + silhouette 评估（Fig. 5；多 seed）显示 seq embedding/struct encoding 分离度接近 0；GRU+Transformer 与 atomic graph processing silhouette 约 0.32–0.34；无 cross-attention 的 concatenation silhouette 0.41–0.43 但呈“细线重叠”；cross-attention silhouette 0.42–0.45 最高
- 可解释：Fig. 6 提供 residue-level 解释：attention 权重高的残基包括 S/I/C/G；CNN 分支用 CAM 生成多尺度 heatmap（3×3 更局部、9×9 更全局）并结合分子结构标注关键原子（Fig. 6F–I）
- Web server：提供在线预测与置信度；平均 5.4s 处理 10 条序列，支持批量最多 1,000 条（Section 3.6；Fig. 7）

**可复现性/工程注意点（代码检查）**

- AUC 计算：本地 `evalution.py` 直接用“预测标签”计算 `roc_auc_score`，严格来说应使用“预测概率”；建议你复现实验时改成用 `softmax(outputs)[:,1]`
- “原子级图”实现：代码按**每个残基的SMILES**构建局部原子图并堆叠，而不是整条肽的全局分子图；这点在写论文/解释时需要表述清楚（它仍能编码侧链化学环境，但不直接表达跨残基成键/构象）
- 框架与训练：PyTorch；`Code/main.py` 使用 CrossEntropyLoss + AdamW(lr=1e-3)，batch_size=32、epochs=100；模型超参为 d_model=256、n_layers=2、n_heads=4，结构分支 CNN 核为 (3,5,7,9)，并以 test accuracy 作为“最佳模型”保存条件（`best_model_0.9.pth`/`best_model_0.8.pth`）
- 设备判断小坑：`evalution.py` 里 `torch.device("mps" if torch.cuda.is_available() else "cpu")` 与常见写法不一致（有 CUDA 时会误选 mps），若你在 Linux/CUDA 环境跑评估建议改成 `cuda`/`cpu` 分支

---

## 7) pepADMET（J Chem Inf Model：多端点平台；毒性模型 MLR-GAT 多类分层）

**论文信息**

- 标题：pepADMET: A Novel Computational Platform For Systematic ADMET Evaluation of Peptides
- 期刊/年份：Journal of Chemical Information and Modeling（ACS）
- DOI：10.1021/acs.jcim.5c02518
- 平台：`https://pepadmet.ddai.tech`

**任务与输出**

- 平台覆盖 19 个关键 ADMET 端点（7 个 ADME + 12 个 toxicity），形成 26 个独立数据集、17 个端点模型
- 对“毒性”不仅做二分类，还做**多类别/机制**层次化预测（MLR-GAT）

**数据来源与数据规模（论文明确给出）**

- 总数据：36,643 条高质量 ADMET 数据（去重后）
- 数据来源（开放数据库 + 文献挖掘）：PEPlife、PepTherDia、THPdb、CycPeptMPDB、Brainpeps、B3Pdb、UniProt、Hemolytik、DBAASP v3，以及已发表文献
- 质量控制：单位标准化、缺失剔除、同分子多测量取均值；仅保留长度 2–50 aa；逐条核对 sequence 与 SMILES；缺失 SMILES（天然肽）由序列转换生成，修饰肽由人工补全结构后生成；按 InChIKey 去重

**毒性模型 MLR-GAT 的创新点（论文主张）**

- **多层级（multilevel）毒性预测**：不仅仅是溶血毒性；能分层识别多类别毒性
- **同时解决 multitask + multiclass**：论文明确指出 MLR-GAT 面向多任务多类别
- **双通路架构**：  
  - 通路1：SMILES→分子图→RGCN 提取拓扑特征  
  - 通路2：由序列/SMILES 计算描述符→MLP 提取理化特征  
  - 两通路融合后输出（论文 Figure 2）
- **具体毒性任务示例（论文 Figure 3 描述）**：binary toxicity classification、six-class toxicity categorization、four-class neurotoxicity mechanism classification
- 工程层面：首次同时支持 linear/cyclic/modified/natural peptides，并考虑 species/organ/cell line 造成的生物差异

**评价方式（论文）**

- 多数端点：随机划分 8:1:1（train/val/test），重复 5 次随机划分训练
- 分类指标：ACC、AUC、Recall、Precision、F1
- 回归指标：R2、MAE、RMSE
- 超参：grid search；分类以 CV-ACC 为优化目标，回归以 CV-R2 为优化目标

**论文结果（毒性相关指标，正文）**

- 六分类毒性分类（six-class toxicity classification，Figure S8）：ACC=0.885，AUC=0.949（test set）
- 其余分类任务（正文概述）：binary toxicity、four-class neurotoxicity、BBB 等均达到 AUC>0.85（具体数值主要在补充图表）

**基准模型与评估方法简述（结合论文写法）**

- 建模算法池（正文）：传统 ML（RF/XGBoost/SVM/DT/GBT/LightGBM）+ GNN + transfer learning；并使用 RFE-RF + 5-fold CV 做特征选择
- 平台对比（Table 1）：与 BBPpred/BBPpredict/DeepB3P/HemoPI-MOD/EnDL-HemoLyt/ToxinPred 3.0 等 web tools 进行功能与端点覆盖对比（强调多端点与多类别毒性）

**结果补充（除指标外：数据扩展/建模筛选/平台验证）**

- 数据规模与层级任务：binary toxicity 数据集由 7,513 扩展到 14,660，并进一步拆分为 6 个 toxicity type 数据集和 4 个 neurotoxicity mechanism 数据集；HC50 数据由 1,926 扩展到 2,423（正文描述）
- 特征筛选与模型选择：对描述符/指纹做 variance filtering（variance <0.01）与 correlation filtering（correlation >0.99），再用 RFE-RF + 5-fold CV 选特征；算法池覆盖传统 ML + GNN + transfer learning；分类以 CV-ACC、回归以 CV-R2 做 grid-search 超参优化（Tables S2/S3/S6）
- 结果呈现方式：Fig. 3D–F 汇总三项毒性任务的数据分布（binary/six-class/four-class neurotoxicity），Fig. 3H 汇总最佳分类模型表现；作者指出除 six-class 之外，binary toxicity 与 neurotoxicity 等任务也达到与已有工作相当的效果（Fig. S7/S9 等），整体分类模型 AUC 多数 >0.85

**本地代码与数据可用性核对（`dd_model/pepADMET`）**

- 代码位置：`/root/private_data/dd_model/pepADMET`
- 可直接用的数据文件（仓库自带）：
  - `data/Toxicity.csv`：135 条样本、共 2139 列（前 6 列为标签/分组/SMILES，后 2133 列为分子/序列描述符特征）；包含 4 个任务字段：`toxicity_nontoxicity`（二分类）、`toxicity_type_class`（6 类）、`neurotoxicity_type_class`（4 类）、`HC50`（回归）；并带 `group∈{training,valid,test}`（各 45 条）
  - `data/Toxicity.bin`：由 `utils/build_dataset.py` 用 DGL `save_graphs` 保存的分子图与标签（含 `labels` 与 `mask`，支持“多任务缺失标签”的训练）
  - `data/Toxicity_group.csv`：135 行（`smiles/group/descriptor`），其中 `descriptor` 为 2133 维特征向量序列化后的列表字符串（供训练 notebook 读取）
  - `data/example.csv` + `data/example_feature_result.csv`：示例序列/SMILES 与其 2133 维描述符计算结果（由 `calculate_descriptors.py` 生成）
- 数据的“可用性结论”：本地仓库提供的是**小规模示例/教学数据**（且每条样本通常只标注 4 个任务中的一个，其他任务为空，通过 `mask` 处理），无法直接复现论文中“36,643 条总数据、14,660 条 binary toxicity”等全量规模；但可用于复现实验流程/调通特征与图构建/做原型验证
- 与论文数据构建的一致性核对（能对上/对不上的点）：
  - 一致：特征与表征管线与论文一致（RDKit 图、PyBioMed + modlAMP 描述符；仓库声明 2133 descriptors，且 `Toxicity.csv` 后 2133 列为特征）
  - 差异：论文强调“36,643 条 ADMET 数据、19 属性、26 子数据集、17 端点模型”；本地仓库仅附带一个 `Toxicity*` 示例数据集与单个预训练权重 `model/toxicity_early_stop.pth`

---

## 8) ToxGIN（Briefings in Bioinformatics 2024；从代码反推）

**代码位置**

- `dd_model/ToxGIN`（README 给出论文链接：Briefings in Bioinformatics, 2024，bbae583）

**任务与输出**

- 肽毒性二分类，输出毒性概率（Sigmoid）

**数据形态与来源线索（代码/README可确认的部分）**

- 序列与标签：`train_sequence.csv`（3,864 条）与 `test_sequence.csv`（564 条），均为严格平衡（1:1）
- 结构：README 声称由 ColabFold 预测肽结构（PDB）；本地 `train_structures/` 与 `test_structures/` 仅含下载链接（Google Drive）

**模型创新点（代码可确认）**

- **结构图建模**：把肽 3D 结构转成残基图（距离阈值建边），用 GIN 做图同构网络聚合
- **多源节点特征**：将 ESM2 残基 embedding 与 AAindex1 理化特征拼接成节点特征，再送入 GIN
- **多尺度GIN表示**：拼接每层GIN输出形成多尺度表征（`out_dim = hidden_dim*(layer_num+1)`）
- **训练策略**：5-fold StratifiedKFold；early stopping 监控 MCC；并在训练中做随机节点删除作为增强

**评价方式（代码）**

- 指标：AUROC、AUPRC、Accuracy、F1、MCC、Sensitivity、Specificity、FDR（训练日志/CSV/TensorBoard）

**论文指标提取说明**

- 本地 `docs/` 未提供 ToxGIN 论文 PDF，因此本节未能从论文表格/正文提取“具体指标数值”（仅能从代码确认评估指标种类与评估流程）；如需补齐，请把 ToxGIN 论文 PDF 放入 `docs/`

**可复现性/工程注意点（来自代码与已有梳理）**

- `preprocess.py` 中存在 `.cuda()` 写死（CPU 环境会报错），建议改为 `.to(device)`
- `max_length=60` 且 truncation=True：长度>60会截断（影响长肽）
- AAindex 的归一化在代码中按“每条样本”做 fit_transform（可能引入尺度不一致；但复现论文需保持一致）
- 框架与训练：PyTorch + DGL；`train.py` 使用 5-fold StratifiedKFold（random_state=3407），AdamW(lr=1e-4, weight_decay=1e-2) + ExponentialLR(gamma=0.95)，最多 500 epochs、patience=50；并在训练中做随机节点删除作为增强，early stopping 以 MCC 作为主监控信号（保存每折 `best_model{cv}.pth`）

---

## 9. 横向结论：这些模型“真正的新东西”在哪里？

从本目录 8 篇 PDF 论文 + `/root/private_data/dd_model` 中 7 个相关代码仓库可以看到，毒性预测领域的增量主要集中在以下几类：

1) **多模态融合**（结构/化学/域信息加入序列）  
   - 肽：ToxGIN（3D残基图）、ToxiPep（原子图/化学图）、HyPepTox-Fuse（PLM+传统描述符）  
   - 蛋白：ToxDL2（ESM2 + 结构图 + domain embedding）
2) **更“难”的泛化评估设计**  
   - 同源去冗余 + 更严格阈值（ToxiPep：0.9/0.8）  
   - 外部实验独立集（ToxiPep：DBAASP 溶血）  
   - 时间外推（ToxDL2：post-2022 holdout）
3) **不平衡与负样本构建**  
   - UniProt/SwissProt 的关键词排除策略几乎成了事实标准（KW-0800/KW-0020、NOT toxin…）  
   - 采样策略：SMOTE（ToxMSRC；MultiToxPred 1.0 也用 SMOTE 把 28 类平衡到每类 942）、聚类选负样本（ProToxin）、分布偏差控制（ToxiPep）；同时要警惕“随机序列当负样本”会高估泛化
4) **可解释性从“口号”走向“可交付物”**  
   - 集成注意力/Transformer（HyPepTox-Fuse、ToxiPep）  
   - Integrated Gradients 找 motif（ToxDL2）  
   - 但需注意：attention 不等于因果解释；更推荐“梯度归因 + 对照实验”一起报告
5) **从“二分类”扩展到“多类别/多任务毒性”**  
   - pepADMET 的 MLR-GAT 明确把毒性做成多层级、多类别甚至机制分类（更贴近真实安全评估）

---

## 10. 面向你要做的“毒性预测模型”的建议（可落地、可复现）

如果你的目标是做一个可发表/可产品化的毒性预测模型，建议按下面的顺序做决策与设计：

1) **先定义毒性标签的“语义”**  
   - 是“广义毒性”（是否标注为 toxin/venom）？还是“溶血毒性/细胞毒性/神经毒机制”等具体端点？  
   - pepADMET 的做法提示：把毒性拆成多端点/多类别可能更贴近真实，但数据成本更高
2) **数据构建优先保证：去泄漏 + 可解释字段**  
   - 去冗余：至少做 CD-HIT 0.9；想强调泛化可加入 0.8  
   - 切分：除了随机切分，至少保留一个“外部/时间外推/实验独立集”  
   - 记录元数据：来源库、物种、实验条件（尤其是溶血阈值/细胞系），否则“毒性”会混成噪声标签
3) **模型路线建议（从低风险到高收益）**  
   - 强基线：PLM(ESM2 small/medium) + 轻量 pooling/MLP（成本低、泛化强）  
   - 融合增强：参考 HyPepTox-Fuse（PLM+精选描述符）或 ToxiPep（序列上下文+化学图），用 cross-attention/Transformer 做融合  
   - 结构增强：若你能稳定获得结构（AF/CF），可走 ToxGIN/ToxDL2 的 residue graph 路线，但要警惕结构噪声与成本
4) **评估与报告的“硬指标”**  
   - 指标：AUROC + AUPRC + MCC（不平衡时优先）+ BACC（如极不平衡）  
   - 校准：概率可用性（ECE/可靠性曲线），否则产品化输出不可信  
   - 复现：固定 splits、固定随机种子、明确阈值选择策略（如最大 MCC 或 Youden）
5) **实现层面要避免的常见坑（从本地代码检查归纳）**  
   - AUC/AUPRC 一定用“概率”，不要用“硬标签”  
   - 归一化不要在每条样本上 fit（除非你明确要这么做并写进方法）  
   - 结构/序列截断要写清楚并做消融（对长肽很敏感）

---

## 11. 基于《毒性预测项目计划_v1》的潜在创新点（围绕“概率 + 把握 + 证据 + 改造建议”）

更新时间：2026-01-15 17:53:16 +0800

> 来源：`/root/private_data/aa_peptide/toxin/docs/毒性预测项目计划_v1.md`。以下是把该方案“打磨成论文贡献”的角度整理（尽量对应可做实验与可写结果图表）。

**A. 你的方案相对现有论文的差异化定位（写作时可直接用）**

- **不依赖结构预测**：与 ToxGIN/ToxDL2 的“结构图”路线区别明确，主打更轻量、更易部署（尤其适合短肽的高通量筛选）
- **从“预测器”升级为“决策支持系统”**：把 `Predictor + Explainer + Retriever + Designer` 打包成一个闭环；多数论文只做到其中 1–2 个模块（预测+解释），很少同时覆盖“不确定性 + 证据检索 + 可执行改造”
- **把不确定性当作一等公民**：不仅输出 `p(toxic)`，还输出“证据强度/把握”（Dirichlet evidential head），并用选择性预测/校准来证明“把握是可用的”
- **解释可追溯**：用 IG（梯度归因）+ attention（权重）双解释器，并可落盘解释文件（便于复核/审稿）
- **建议可验证**：把“改造建议”定义为可评估任务（flip/reduce hit rate + 约束 + coverage），而不是仅给 qualitative demo

**B. 可发表创新点候选（按优先级/落地度排序）**

1) **轻量序列模型 + 可部署训练/推理**  
   - 方法：small/medium PLM（ESM2 8M/35M/150M 或同级）+ adapter + light-attention pooling（或更轻的 pooling）  
   - 贡献点：证明“不用结构也能达到强性能”，并量化成本（吞吐、显存/内存、CPU 推理时间）

2) **Evidential 毒性预测：概率 + 证据强度 + 不确定性**  
   - 方法：Dirichlet evidential head 输出 `alpha`，同时给 `p_toxic`、`uncertainty`、`total_evidence`  
   - 贡献点：面向部署的“低把握提醒/实验建议”；比单纯 softmax 概率更可解释  
   - 关键对照：同 backbone 的 sigmoid/softmax head、MC Dropout、Deep Ensemble（至少选 1 个做对比）

3) **“把握”驱动的评估范式：校准 + 选择性预测（Selective prediction）**  
   - 贡献点：把 ECE/可靠性曲线 + risk-coverage 曲线作为主结果之一（不是附录），直接证明“模型知道自己不知道”  
   - 可扩展：把不确定性阈值作为产品策略（高风险/低证据→建议实验/不出结论）

4) **检索增强的“证据输出”（Retrieval as Evidence）**  
   - 方法：在训练集/外部库检索 TopK 相似序列（TF‑IDF char n-gram 或 embedding ANN），展示相似度+label+来源（后续可接 DOI/实验条件）  
   - 贡献点：把预测结论绑定“可核验样本证据”，提升可信度；可把“证据强弱”与不确定性联动（相似度低且 uncertainty 高→强 OOD 信号）

5) **检索增强的“预测/不确定性校正”（Retrieval for Calibration，选做但容易形成亮点）**  
   - 方向 A：把 kNN 证据（TopK label vote/距离分布）作为额外特征拼接到分类头（小成本提升稳健性）  
   - 方向 B：用检索到的邻域一致性做正则（邻域内应预测一致；不一致样本应给低证据）

6) **双解释器 + “解释一致性”指标**  
   - 方法：IG attribution 与 attention 权重共同输出；用 motif 命中（k-mer/信息论 motif）做第三视角  
   - 贡献点：给出“解释一致性”（如 top‑k 位点重合率/相关系数）与“解释可靠性”案例（高把握样本解释更稳定）

7) **证据驱动的最小编辑：把改造建议做成“反事实解释 + 可执行候选”**  
   - 方法：Evidence-guided neighbor edits（从相似 non-toxic neighbor 逐差异位点做单点替换），每条建议都可回溯到“相似但不毒”的证据序列  
   - 贡献点：比“全扫描给 top mutation”更像可解释的药物优化流程（最小编辑 + 证据支撑）

8) **归因驱动的局部扫描：以 3× 更少候选逼近全扫描上限（你 v1 结果已在项目计划中验证）**  
   - 方法：用 attribution 选 Top‑M 位点做 19AA 替换扫描，并在 `p_toxic` 与 `uncertainty` 目标下排序  
   - 贡献点：把“设计模块”从昂贵的穷举变成可部署的启发式优化；用候选数量/耗时与命中率做 trade-off 图

9) **不确定性约束下的改造评估协议（Design Hit Rate under Uncertainty Constraint）**  
   - 指标：Flip hit / Reduce hit + coverage + cand_mean + Δp_mean + Δunc_mean；同时报告 strict/relaxed uncertainty 约束  
   - 贡献点：给出面向产品的“建议可信度”定义（改造不应通过提高不确定性来“骗过模型”）

10) **复现与审计友好：Agent-ready 的结构化输出与产物清单**  
   - 贡献点：把每次预测输出固化为 JSON（含模型版本、数据版本、解释文件、证据条目、改造候选），并提供可复现脚本（你计划里已经有雏形）  
   - 审稿加分点：固定 split + manifest/hash + 可下载预测结果与解释结果

**C. 建议写成论文“主张→证据”的结构（方便你后续写 Introduction/Results）**

- C1（性能/成本）：小/中型 PLM + adapter 在固定 split 与外部测试上达到强性能，同时显著降低结构路线的工程成本  
  - 证据：AUROC/AUPRC/MCC + 推理耗时/显存/吞吐；对照（无 PLM / 大 PLM / 结构模型）
- C2（可信度）：evidential head 提供可用的不确定性信号，并带来更好的校准与选择性预测收益  
  - 证据：ECE、可靠性曲线、risk‑coverage、错误样本 vs 正确样本 uncertainty 分布
- C3（可解释与证据）：预测结论可由“位点解释 + 相似样本证据”共同支撑，并能识别低证据/OOD 输入  
  - 证据：case study（高/低把握各 2–3 条）+ 解释一致性 + 检索证据强弱与错误率相关性
- C4（可改造）：在约束下生成“低毒且低不确定”的候选，并用可复现实验定义命中率与效率上界  
  - 证据：design hit rate（flip/reduce）+ 候选数/耗时对比（evidence edits vs attribution scan vs full scan），再加 2–3 条可视化案例（原序列→候选→解释/证据）

**D. 你已经具备的“可直接转成论文结果”的素材（基于项目计划中的现有实验）**

- v1 数据固定划分下的端到端闭环验证：预测指标 + ECE + 选择性预测收益 + 证据检索命中率
- 改造模块的三策略对比：命中率接近全扫描、候选数显著降低（适合作为核心结果表/图）

**E. 可能被审稿人追问的点（提前准备）**

- “改造建议是否有实验验证”：明确声明当前为 in‑silico 筛选与优先级建议；可在 Discussion 给出最小 wet‑lab 验证计划（少量 top candidates 的溶血/细胞毒实验）  
- “标签语义不统一/噪声”：用 evidential 不确定性 + 检索证据强弱做风险提示；并在 Methods 明确数据来源与过滤  
- “数据泄漏/同源泄漏”：坚持 cluster-based split（如 id90/id80）、检索只建在 train 上，外部库加入去重策略并提供脚本与 hash

---

## 12. 数据收集与可用数据复核（pepADMET 代码 + 其他论文）

更新时间：2026-01-16 07:03:58 +0800

**12.1 pepADMET（论文）数据收集流程（再核对）**

pepADMET 论文在 “Data Collection and Preprocessing” 对数据收集/清洗给了较完整的可复现描述，核心要点如下（按原文步骤整理）：

- 数据来源：开放数据库 + 文献挖掘。明确列出来自 PEPlife、PepTherDia、THPdb、CycPeptMPDB、Brainpeps、B3Pdb、UniProt、Hemolytik、DBAASP v3 等，以及 published literature
- 组织方式：先按 ADMET 属性分类，再细分子类，最终得到 26 个独立数据集用于建模
- 质量控制/预处理（原文列出 4 步）：
  1) 抽取标签与实验值、统一实验单位、删除缺失；同一分子多次测量取算术平均
  2) 仅保留长度 2–50 aa 的肽
  3) 逐条核对 sequence 与 SMILES；缺失 sequence 人工补全；天然肽缺失 SMILES 由序列转换生成；修饰肽先人工补全修饰结构再生成新 SMILES
  4) 用 InChIKey 去重
- 最终规模：完成上述流程后得到 36,643 条高质量 ADMET 数据，覆盖 19 个关键属性（7 个 ADME + 12 个 toxicity，见 Table S1）

**12.2 pepADMET（代码）是否自带可用数据？**

结论：`dd_model/pepADMET` 仓库**自带可直接使用的数据**，但规模为示例/教学级，不能等价视为论文全量数据。

- 仓库位置：`/root/private_data/dd_model/pepADMET`
- 自带数据（可直接用于复现实验流程）：
  - `data/Toxicity.csv`（135×2139）：含 4 个毒性相关任务字段 `toxicity_nontoxicity`（二分类）、`toxicity_type_class`（6 类）、`neurotoxicity_type_class`（4 类）、`HC50`（回归），以及 `group∈{training,valid,test}` 与 `smiles`；其余 2133 列为描述符特征
  - `data/Toxicity.bin`：DGL 图数据（含 `labels` 与 `mask`；用于缺失标签的多任务训练）
  - `data/Toxicity_group.csv`：135 行（`smiles/group/descriptor(2133维)`，descriptor 为列表字符串）
- 与论文一致/不一致：
  - 一致：特征/表征实现与论文一致（RDKit 图 + PyBioMed/modlAMP 描述符；descriptor 维度=2133）
  - 不一致：论文中 36,643 条 ADMET 数据与多端点数据集未随仓库发布；本地仅有 `Toxicity*` 小数据与单个预训练权重 `model/toxicity_early_stop.pth`

**12.3 其他论文的数据收集方式（逐篇核对要点）**

| 工作 | 任务对象 | 正样本来源（toxic） | 负样本来源（non-toxic） | 去冗余/过滤 | 平衡/采样策略 | 备注（本地可用数据） |
|---|---|---|---|---|---|---|
| HyPepTox-Fuse | 肽 | 多库汇总：Conoserver、DRAMP3、CAMPR3、dbAMP2、YADAMP、DBAASP-v3、UniProt、SwissProt（沿用 ToxinPred3 整理版） | UniProt 查询：`NOT toxin NOT toxic AND reviewed: yes`（沿用 ToxinPred3） | 论文说明来自既有基准集（已清洗/去重）；并设置独立集 | 训练集本身平衡（5,518/5,518） | 本地有原始 FASTA（`dd_model/toxin/HyPepTox-Fuse/raw_dataset/*.fa`） |
| ToxiPep | 肽 | 基准毒肽 + DRAMP4/dbAMP3 reviewed toxic；外部独立集 toxic 来自 DBAASP（实验溶血） | reviewed UniProt/SwissProt 且排除 toxin/过敏标注（论文给出 query）；外部独立集 non-toxic 同策略构建 | CD-HIT=0.9/0.8 双阈值；并移除与 ToxinPred3 训练集重叠样本（防泄漏） | 主要为“去泄漏与泛化评估”设计（而非采样平衡为主） | 本地有划分文件与独立集（`dd_model/ToxiPep/Dataset/...`） |
| ToxMSRC | 肽 | 合并 CSM-Toxin/ToxinPred2/ATSE；删长度>50 | UniProt：`NOT KW-0800 AND NOT KW-0020 AND reviews: true`；删非标准 AA/长度>50；再与三来源合并并剔除冲突标签 | CD-HIT=0.9（得到 2,138 pos / 5,375 neg）；再切 benchmark/test1 并引入 test2 | 训练阶段用 SMOTE 对正样本过采样（1,818→3,636） | 本地有 FASTA（`dd_model/ToxMSRC/Raw data/*.fasta`） |
| ToxDL 2.0 | 蛋白 | UniProt release 2024_03：`(keyword: KW-0800) AND (reviewed: true)` | `NOT KW-0800 AND NOT KW-0020 AND (reviewed: true)`（显式排除 allergen） | 去非标准 AA、去重；CD-HIT 去冗余并控制同源泄漏；按时间切分 pre-2022 vs post-2022 | 不平衡（独立集约 1:30）；论文用 focal loss 等策略缓解 | 本地有 FASTA 与 domain 数据（`dd_model/ToxDL2/data/...`；PDB仅样例） |
| ProToxin | 蛋白 | UniProt（2024-09-09）：KW-0800 + reviewed | 排除 KW-0800 与 KW-0020 + reviewed | 去长度<35、去非标准 AA；再做系统性特征选择 | 用 K-means + elbow/SSE（k=8）从海量非毒蛋白中挑代表样本（8,412）以平衡训练集 | 本地无代码/无数据（论文称数据在其网站） |
| MultiToxPred 1.0 | 蛋白 | UniProt reviewed + 文献验证毒素活性 + 完整序列（27 类毒素共 6,023） | 600 条随机氨基酸序列（non-PT） | 论文未报告 CD-HIT/cluster split；按作用机制/靶点分 27 类 + non-PT | SMOTE 类平衡到每类 942；80/20 随机切分 + 10-fold CV（notebook 显示可能先 SMOTE 再切分） | 本地有 FASTA + 平衡特征（`dd_model/MultiToxPred/`） |
| ToxPre-2L | 肽 | 2,345 条实验验证 TXP（长度 10–50） | Swiss-Prot 过滤毒/过敏关键词与 KW-0020/KW-0800，长度 10–50；删非标准残基；CD-HIT=0.9 后得到 4,125，再抽样 2,345 以平衡 | CD-HIT=0.9（nontoxic 内去冗余） | 最终构建平衡数据集（2,345/2,345）；Level-2 做多标签 | 本地无代码/无数据（论文给出网站入口） |
| ToxGIN | 肽 | （本地仅能从代码确认）`train_sequence.csv/test_sequence.csv` 给出平衡标签；结构由 ColabFold 预测（链接） | 同上 | 结构文件需外部下载；其余过滤/去冗余需论文 PDF 才能完全复核 | 代码用 5-fold StratifiedKFold；训练中做节点删除增强 | 本地有序列标签 CSV（结构需下载链接） |

---

## 13. 如果你要自己从文献收集“毒性序列”数据：建议流程与优先读哪些论文

更新时间：2026-01-16 07:03:58 +0800

你要自己从文献收集“毒性序列”，最关键不是“能抓到多少序列”，而是把 **毒性标签语义 + 实验端点 + 去泄漏切分** 做成可复核、可复现的 SOP。下面给一个可执行流程（先从数据库索引文献，再做补采）。

### 13.1 先把“毒性”定义成可操作的标签

建议只选其中一类任务来建数据集（否则标签会混）：  
1) **广义毒素/毒蛋白**：toxin / non-toxin（常见来源：UniProt KW-0800）  
2) **毒性肽二分类**：toxic / non-toxic（多来自毒肽数据库汇总 + 构造负样本）  
3) **具体实验端点（更推荐）**：溶血（HC50）、细胞毒性（IC50/EC50）、神经毒机制等；可做二分类（阈值）或回归（保留数值）

### 13.2 数据来源优先级：数据库→引用→原文

- 先用数据库把“序列 + 实验值 + 引用”打包拿到（它们本质上就是“从文献结构化抽取”的成果），再做增量补采：  
  - 肽/毒肽/溶血：DBAASP、DRAMP、dbAMP、Hemolytik 等  
  - 毒素蛋白：UniProt/Swiss-Prot（reviewed；KW-0800；可追溯 PMID/DOI）  
  - 多端点/多类别：如 pepADMET / MultiToxPred 的做法（但注意其负样本构造）

### 13.3 文献检索（可直接用的 query 模板）

用“端点 + sequence + assay”组合检索，避免只搜 “toxic peptide”：  
- 溶血：`(hemolysis OR hemolytic) AND peptide AND (sequence OR \"amino acid sequence\")`  
- 细胞毒：`(cytotoxicity OR cytotoxic) AND peptide AND (IC50 OR EC50) AND sequence`  
- 神经毒/离子通道毒素：`(neurotoxin OR \"ion channel\") AND (peptide OR toxin) AND sequence`

抓到候选论文后，优先看 Supplementary/Appendix 的序列表与 Methods 中对阈值/实验条件的定义（不同 RBC/细胞系会导致标签不可比）。

### 13.4 抽取字段（最小可复现表）

每条序列至少记录：`sequence`、`length`、`endpoint`、`label/value`、`unit`、`assay_system+condition`、`paper_doi/pmid+table_id`、`source_db`（若来自数据库），以及修饰/非标准残基的处理规则。

### 13.5 质量控制与去重（决定能否发表/上线）

- 单位统一、阈值统一；同一序列多测量：保留原始记录 + 派生聚合值（平均/中位数）
- 去重：肽按 `sequence`（修饰肽需声明是否视为新分子），蛋白按 accession/序列
- 去掉 B/J/O/U/X/Z 等非标准残基（或单独打“低置信”标签）
- **同源泄漏控制**：必须做 cluster split（肽常见 CD-HIT 0.9/0.8；蛋白可用 mmseqs2/CD-HIT），并在 Methods 固定 split+hash

### 13.6 负样本怎么收集（强烈不建议随机序列）

- 肽：优先用明确标注 non-toxic / non-hemolytic 的条目；否则用 UniProt/Swiss-Prot 过滤构造并记录 query
- 蛋白：常用 `NOT KW-0800 AND NOT KW-0020`（排除 allergen）+ reviewed，再控制物种/长度分布与正样本接近
- 不要用随机序列当 non-toxic（MultiToxPred 的 `negative_600.fasta` 更适合演示工具，不适合作为可信基准）

### 13.7 建议优先读哪些论文（按“怎么构数据集”来读）

- **毒性肽二分类/去泄漏**：ToxiPep、HyPepTox-Fuse、ToxMSRC；并建议补读 ToxinPred 系列（尤其 ToxinPred3，很多后续工作直接沿用其基准）
- **毒素蛋白（KW-0800）/不平衡/时间外推**：ToxDL 2.0、ProToxin、MultiToxPred 1.0（机制多分类但负样本构造需你改）
- **多端点毒性（把“毒性”拆为多个实验属性）**：pepADMET（数据清洗流程写得最接近“可复现 SOP”）

---

## 14. 文献检索与全文获取（合法）+ 从实验文献构建数据集的落地做法

更新时间：2026-01-16 08:06:27 +0800

你问的 4 个问题可以对应成一个闭环：**检索 → 合法获取全文/补充材料 → 在论文里定位实验数据 → 抽取/清洗/切分形成数据集**。下面是可执行的做法。

### 14.1 文献检索怎么做（平台 + 组合策略）

建议至少并行用 3 类入口（互补）：  
1) **PubMed**：生物医学最强，适合端点词（hemolysis/cytotoxicity/IC50 等）  
2) **Google Scholar**：覆盖更广，适合找 preprint、作者主页、补充材料链接  
3) **Web of Science / Scopus（如有权限）**：适合系统综述、被引追踪、领域全景

一个高命中、低噪声的检索式通常由 3 段构成：  
- **端点/实验读出**（你要的标签语义）：hemolysis / cytotoxicity / IC50 / EC50 / LD50 / neurotoxin / toxicity  
- **对象**：peptide / antimicrobial peptide / venom peptide / conotoxin / toxin protein  
- **可抽取性提示词**：sequence / “amino acid sequence” / assay / “supplementary table” / “supporting information”

然后用 4 个“增强动作”（比换关键词更重要）：  
- **Snowballing**：对 1 篇核心论文做 References（向后）+ Cited by（向前）  
- **Review → 原始实验**：先锁定 1–2 篇综述/数据库论文，从它们引用里抓可抽取的实验文献  
- **数据库当索引**：DBAASP/DRAMP/Hemolytik/UniProt 记录自带引用（PMID/DOI），直接定位原文最省力  
- **设置提醒**：PubMed/Scholar alerts（关键词 + 近 2 年），持续补采

### 14.2 可直接复制的检索 query 模板

- 溶血（HC50/percent hemolysis）：  
  `((hemolysis OR hemolytic) AND peptide AND (HC50 OR \"percent hemolysis\" OR erythrocyte) AND (sequence OR \"amino acid sequence\"))`
- 细胞毒（IC50/EC50 + 细胞系）：  
  `((cytotoxicity OR cytotoxic) AND peptide AND (IC50 OR EC50) AND (cell line OR MTT OR CCK-8) AND sequence)`
- 神经毒/离子通道靶向毒素（机制/靶点）：  
  `((neurotoxin OR \"ion channel\") AND (venom OR toxin) AND (target OR receptor) AND sequence)`
- 毒素蛋白二分类（偏注释构建）：  
  `((toxin OR toxic) AND (UniProt OR Swiss-Prot) AND reviewed AND (keyword OR KW-0800))`

实操建议：先用宽 query 找到 10–30 篇“确实含序列/实验值”的种子文献，再从种子文献做 snowballing；不要指望一次 query 就覆盖全域。

### 14.3 如何合法获取全文与补充材料（不要走灰色渠道）

合规优先级（从高到低）：  
1) **Open Access / PubMed Central (PMC)**：PubMed 页面常有 “Free full text”；PMC 可直接下载 PDF  
2) **出版社官网 + 机构订阅**：通过学校/研究所图书馆 VPN/Proxy 登录下载  
3) **预印本**：bioRxiv/medRxiv/arXiv/chemRxiv（通常包含关键表格与方法）  
4) **作者可分享版本**：作者主页/课题组网站/ResearchGate（注意遵守版权条款；仅用于研究用途）  
5) **直接联系作者**：要补充表/原始测量数据（很多序列表 Excel 只在作者手里）

关键提醒：很多“能抽取数据”的内容在 **Supporting Information / Additional files**，下载全文时要把补充材料一起拿全。

### 14.4 实验数据通常藏在哪（你应该优先翻哪里）

1) **Supporting Information / Supplementary Tables（最高优先级）**：序列列表、IC50/HC50/LD50 原始值、实验条件  
2) **Data Availability**：Zenodo/Figshare/Dryad/OSF/GitHub（可能直接给 CSV/FASTA）  
3) **主文 Table/Figure**：往往只展示 top hits，但会指向补充表  
4) **Methods / Materials**：阈值与条件定义（RBC 来源/细胞系/孵育时间/读出方式），决定标签能否合并  
5) **只给 accession 的情况**：论文用 UniProt/GenBank accession 代替序列正文，这时要去数据库拉序列并记录 accession→sequence 的映射

### 14.5 如何把实验文献变成“可复现数据集”（推荐 SOP）

**Step 0：先写 Dataset Card（边界写清楚）**  
- 任务：二分类还是回归？端点是什么？阈值如何定？长度范围？是否允许修饰？是否跨物种？  

**Step 1：建立“论文清单”与纳入标准（可追溯）**  
- 记录：检索日期、检索式、平台、命中条数；用 Zotero/EndNote 管理并打标签（“有序列表/有实验值/仅机制讨论”）  

**Step 2：结构化抽取（字段要能复核）**  
每条记录建议最少字段：  
- `sequence`、`length`  
- `endpoint`（hemolysis_HC50 / cytotoxic_IC50 / general_toxin / mechanism_class…）  
- `value` + `unit`（保留原单位列；再派生统一单位列）  
- `assay_system` + `condition`（RBC 来源/细胞系/温度/时间/阈值定义）  
- `paper_doi/pmid` + `table_id/supp_file`（保证可复核）  
- `modification` 与 `nonstandard_residue_flag`

**Step 3：标准化与 QC（减少“标签噪声”）**  
- 单位统一；阈值统一；同一序列多测量：保留原始多条 + 派生聚合值（mean/median）  
- 非标准残基（B/J/O/U/X/Z）剔除或降级标注  
- 修饰肽：建议“修饰视为新分子”单独建条目，并记录结构/修饰位点（否则会混语义）  

**Step 4：去重 + 防泄漏切分（必须做）**  
- 肽：按 `sequence` 去重；再做 CD-HIT 0.9/0.8 cluster split  
- 蛋白：按 accession/序列去重；用 mmseqs2/CD-HIT 做 cluster split；固定种子并保存 split 列表与 hash  

**Step 5：负样本构建（决定泛化是否可信）**  
- 端点型任务：优先收集明确 non-hemolytic / non-cytotoxic 的实验记录  
- 若必须构造：用 UniProt/Swiss-Prot reviewed 过滤规则（例如排除 KW-0800/KW-0020），并让长度/物种分布贴近正样本  

**Step 6：版本化产出（让你能写 Methods/让别人能复现）**  
- 输出目录建议：`raw/`（原始抽取表）、`processed/`（标准化表）、`splits/`（cluster split 列表）、`manifest.json`（来源与 hash）  
- Methods 必写：检索策略、纳入标准、单位/阈值、去重阈值、split 规则、重复测量处理方式

### 14.6 批量获取论文：推荐 API/工具（仅限开放获取或你有合法权限）

你完全可以写脚本批量获取“能合法拿到的全文/补充材料”，但要接受一个现实：**不是所有论文都开放获取**；对非 OA 的出版社 PDF，通常需要机构订阅/文本挖掘授权，没法靠通用脚本“强下”。建议用下面这套组合：

- **Unpaywall API（DOI → OA PDF）**：返回最优 OA 位置与 `url_for_pdf`（需要提供 email；有频控与使用条款）  
- **OpenAlex API（DOI → OA 状态 + pdf_url）**：不需要 key，常能直接给 publisher PDF 的 `pdf_url`  
- **Europe PMC API（DOI/PMID → 元数据；PMCID → fullTextXML）**：对 PMC 收录的 OA 文章可直接取 JATS XML（适合文本挖掘）；注意 PMC 的“直接 PDF 下载”可能有反爬挑战，不建议脚本硬抓  
- **Semantic Scholar Graph API（DOI → openAccessPdf，有时可用）**  
- **Zotero（批量管理 + “Find Available PDFs”）**：本质会用 Unpaywall 等 OA 来源自动挂附件；对有机构订阅的情况也方便人工补齐

本项目已在本地提供一个“只抓 OA”的脚本：`/root/private_data/aa_peptide/toxin/docs/scripts/fetch_open_access_papers.py`  
用法示例（在 `docs/` 目录下运行）：

```bash
export UNPAYWALL_EMAIL="you@lab.edu"   # 可选；不设也会尝试 OpenAlex
printf "10.1186/s12859-024-05748-z\n" > papers.txt
python scripts/fetch_open_access_papers.py --input papers.txt --out oa_papers --format both
```

脚本输出会生成：下载文件 + `download_manifest.jsonl`（记录每条输入通过哪个 API 解析、下载链接、sha256）。

---

## 附：本地文件索引（方便你继续点名追问）

- HyPepTox-Fuse PDF：`HyPepTox-Fuse：一种可解释的混合框架，用于准确预测肽毒性，结合蛋白质语言模型嵌入与传统描述符.pdf`
- MultiToxPred PDF：`MultiToxPred1.0：一款新型综合工具，用于通过集合机器学习方法预测27类蛋白质毒素.pdf`
- ProToxin PDF：`ProToxin-无代码-3区-Q1-影响因子4.pdf`
- ToxDL 2.0 PDF：`ToxDL 2.0：利用预训练语言模型和图神经网络进行蛋白质毒性预测.pdf`
- ToxMSRC PDF：`ToxMSRC：基于多尺度卷积神经网络和残余连接的创新肽毒性预测模型.pdf`
- ToxPre-2L PDF：`ToxPre-2L-Bioinformatics.pdf`
- ToxiPep PDF：`ToxiPep：通过融合上下文感知表征和原子级图实现肽毒性预测.pdf`
- pepADMET PDF：`pepADMET-湘雅医学院-刘千惠-肽性质预测平台.pdf`

---

## 15. 当前“原始实验数据”（序列×端点×数值×实验条件）可用性盘点

更新时间：2026-01-16 14:03:07 +0800

你说的“原始的一手数据”，我这里按如下最小定义来判断是否满足：  
**(a) 样本表示（序列/SMILES/结构） + (b) 实验端点名（HC50/IC50/LD50…） + (c) 数值/单位 + (d) 实验系统/条件（RBC/细胞系/时间/温度/阈值定义） + (e) 可复核来源（DOI/PMID + 表格/补充材料定位）**。

### 15.1 结论（先把边界说清）

- 在你目前本地这批“毒性预测模型代码/数据”里：**只有 `pepADMET` 仓库自带的示例数据包含“数值端点”**（`HC50`），但它只给了 **SMILES**，没有给 AA 序列/实验条件/单位细节，因此严格意义上仍不完整。
- 其余工作（HyPepTox-Fuse / ToxGIN / ToxiPep / ToxMSRC / ToxDL2 / MultiToxPred）公开数据基本是 **“序列 + 标签（0/1 或 多分类）”**：标签来自数据库条目/UniProt 注释/作者构造负样本，通常**不提供每条序列对应的实验测量值**（LD50/IC50/HC50 等）与实验条件，所以更适合作为“分类基准数据集”，而不是“实验端点回归/阈值分类”的原始数据源。

### 15.2 本地数据一览（按“原始度”分层）

| 工作/仓库 | 任务对象 | 仓库里实际给了什么 | 是否有 AA 序列 | 是否有数值端点 | 端点/性质（可解释） | 实验方法/条件是否可追溯 |
|---|---|---|---:|---:|---|---|
| `dd_model/pepADMET` | 肽 | `data/Toxicity.csv`（SMILES + 多任务标签/数值 + 2133 描述符） | 否（仅示例 `example.csv` 有 SEQUENCE） | 是（`HC50`） | **溶血毒性**：HC50=hemolytic concentration（50% 溶血浓度，论文明确） | 否（示例 CSV 未给单位、RBC 来源/条件；论文称汇总自多库并统一单位） |
| `dd_model/ToxiPep` | 肽 | 训练/测试/独立集的 FASTA-like 序列 + 0/1 标签 | 是 | 否 | **广义毒性二分类**（标签语义来自基准集 + 构造负样本）；独立集来源含 DBAASP（实验溶血条目） | 否（数据文件无 PMID/实验值/条件定位） |
| `dd_model/ToxMSRC` | 肽 | FASTA 序列 + 0/1 标签；训练用 SMOTE | 是 | 否 | 广义毒性二分类（混合多来源标签） | 否 |
| `dd_model/toxin/HyPepTox-Fuse` | 肽 | FASTA 序列 + 0/1 标签（ToxinPred3 基准集切分） | 是 | 否 | 广义毒性二分类（标签来自多毒肽库汇总） | 否（header 无原始数据库 ID） |
| `dd_model/ToxGIN` | 肽 | `train_sequence.csv/test_sequence.csv`（序列+0/1） | 是 | 否 | 广义毒性二分类 | 否 |
| `dd_model/ToxDL2` | 蛋白 | FASTA（UniProt ID + 0/1 标签）+ domain/少量结构样例 | 是 | 否 | 蛋白毒性注释二分类（KW-0800 vs 非毒） | 部分可追溯（有 UniProt accession，可回溯注释/文献，但无数值端点） |
| `dd_model/MultiToxPred` | 蛋白 | 27 类毒素机制/靶点多分类 FASTA；负样本为随机序列；另有 PAAC/DPC 特征表 | 是 | 否 | **机制/靶点类别**（不是 potency 数值） | 部分可追溯（header 含 UniProt accession；负样本不可追溯且不推荐） |

### 15.3 pepADMET：目前唯一“带数值端点”的本地示例数据（但不完整）

**论文里 HC50 的定义**  
pepADMET PDF 明确给出：`HC50 = hemolytic concentration`（溶血 50% 浓度）。

**仓库里可直接用的数据文件**（你现在本地就有）：`/root/private_data/dd_model/pepADMET/data/Toxicity.csv`  
该文件中毒性相关字段的可用性统计如下（按 non-null 计数）：  
- `HC50`：15 条（数值范围约 0.80–2.61；单位/是否 log 变换在该示例 CSV 中未说明）  
- `toxicity_nontoxicity`：30 条（二分类标签）  
- `toxicity_type_class`：54 条（6 类毒性类别标签）  
- `neurotoxicity_type_class`：36 条（4 类神经毒机制标签）  
- `group`：135 条（training/test/valid）

**这 15 条 HC50 的“可复核定位”**（直接在 `Toxicity.csv` 里按行号找；SMILES 很长，不建议在报告里全量粘贴）：  

| Toxicity.csv 行号（1-based） | split | HC50 | smiles_sha256 前 12 位（用于校验） |
|---:|---|---:|---|
| 121 | training | 2.61 | e27e49ffaf2f |
| 122 | training | 2.25 | 5643d38a7fc3 |
| 123 | training | 1.70 | 89dc026f6fda |
| 124 | training | 2.22 | d65adbf1ab6d |
| 125 | training | 1.47 | 73f2e1ab0598 |
| 126 | test | 1.46 | c30af7a0a548 |
| 127 | test | 0.97 | 4328eef6d9b0 |
| 128 | test | 1.45 | 670447c8f45b |
| 129 | test | 0.80 | 00e247eba60e |
| 130 | test | 1.92 | e12d3f1821b5 |
| 131 | valid | 2.57 | 51e04a799183 |
| 132 | valid | 2.53 | 4c9c82f43034 |
| 133 | valid | 1.70 | 344392e7f059 |
| 134 | valid | 2.47 | 6d8a1516dc26 |
| 135 | valid | 2.31 | 272f577ed37b |

**重要缺口（为什么你会觉得“不是一手数据”）**  
- 该示例数据没有给：`AA 序列`、`HC50 的单位/实验系统（RBC 来源/温度/时间）`、`DOI/PMID`。  
- pepADMET 论文描述其全量数据是从 Hemolytik/DBAASP 等数据库与文献挖掘汇总，并做了“单位统一/重复测量平均/InChIKey 去重/序列与 SMILES 逐条核对”。但这些“可追溯字段”并未随该 GitHub 示例数据发布。

---

## 16. OA 论文“一手实验数据”（序列×数值）抽取试运行结果

更新时间：2026-01-16 16:54:02 +0800

你要的“最原始的一手数据（序列 + 实验测量值 + 可追溯定位）”，本轮我已把 **OA 论文的表格/补充材料** 跑通自动抽取，并把结果落盘为可复核的 CSV（每条记录带 DOI/PMCID + 表格行列定位 + 表格 caption）。

### 16.1 输出位置（你直接去看文件）

- 下载目录（全文 PDF + JATS XML + 补充材料）：`/root/private_data/aa_peptide/toxin/docs/papers_oa_experimental_amp/`
- 抽取后的“序列-端点-数值”原始记录：`/root/private_data/aa_peptide/toxin/docs/papers_oa_experimental_amp/raw_experimental_records.csv`
- 可复核表格 CSV：`/root/private_data/aa_peptide/toxin/docs/papers_oa_experimental_amp/extracted_tables/`

复现命令：

```bash
python scripts/extract_paper_extractions.py --input-dir papers_oa_experimental_amp --overwrite
```

### 16.2 抽取到的数据量（来自论文表格/补充材料）

本轮 `papers_oa_experimental_amp/raw_experimental_records.csv` 统计：

- 总记录数：211（每条 = 1 条序列 × 1 个端点值 × 1 个条件/列）
- 唯一序列数：29
- 端点类型：`MIC` 131、`MBC` 66、`HEMOLYSIS`(%) 11、`IC50` 3

按论文分布（均为 OA，且带 PMCID，可追溯到 XML 表格）：

| DOI | PMCID | 论文标题（简写） | 记录数 | 端点示例 |
|---|---|---|---:|---|
| 10.1021/acsomega.5c01863 | PMC12199084 | AapA1/IbsC/Fst1 抗菌肽理性设计 | 143 | MIC/MBC（µM），溶血% |
| 10.3390/antibiotics14111077 | PMC12649549 | 序列置换生成 Lys/Trp 富集 AMP | 52 | MIC |
| 10.3390/microorganisms13102355 | PMC12566520 | DGL13K 定向修饰 | 13 | MIC（µg/mL） |
| 10.3390/ph18060862 | PMC12195976 | Pep-38 衍生 AMP 设计 | 3 | IC50 |

### 16.3 “可复核定位”怎么用（你关心的一手性）

`raw_experimental_records.csv` 中关键字段：

- `sequence`：从“序列表”抽取的规范 AA 序列（会去掉 `-NH2/-OH/*` 等标记；原始单元格在 `sequence_raw`）
- `peptide_id`：论文表格里的肽编号/名称（用于跨表关联）
- `endpoint`：MIC/MBC/HEMOLYSIS/IC50 等
- `value` + `unit`：数值与单位（如 `µM` / `µg/mL` / `%`）
- `condition`：该数值对应的条件列（例如菌株缩写 `E. c.`、或 `hemolysis at 400 µM`）
- `source_ref`：定位到**端点值所在表格单元格**（`table_id + row_idx + col_idx + header_row_idx`）
- `context`：包含 `table_caption` 与 `seq_source_ref`（序列来自哪张表/哪一格），便于逐条审计

当前已覆盖的典型结构：
- “序列表”与“MIC/MBC 表”分离：通过 `peptide_id` 跨表拼接
- `MIC (MBC)` 单元格形如 `4 (8)`：会拆成两条记录（MIC=4、MBC=8）
- `hemolysis at 400 µM` 这种百分比列：会抽取为 `endpoint=HEMOLYSIS`、`unit=%`

### 16.4 重要边界（还没覆盖/需后续增强）

- 图（figure）里只有柱状图/散点图的溶血曲线：目前不做图像数值反推；需要额外的图表数字化流程。
- “原始实验条件”字段（缓冲液、RBC 来源、温度、时间、菌株全称等）目前以 `table_caption/context` 与 `conditions`（简易正则）为主，尚未做系统化抽取与标准化。

### 16.5 第二批试运行：10 篇 OA（更偏“毒性/细胞实验”关键词）

更新时间：2026-01-17 06:17:40 +0800

本轮我又额外跑了 10 篇 OA（DOI 清单：`runs/oa10_toxicity_seq/paper_ids.txt`），并把全文 XML/PDF/补充材料下载到 `runs/oa10_toxicity_seq/papers/`，随后自动抽取“序列 × 端点 × 数值”的可审计记录。

**输出位置（这次的 run）**

- 下载目录：`/root/private_data/aa_peptide/toxin/docs/runs/oa10_toxicity_seq/papers/`
- 原始抽取：`/root/private_data/aa_peptide/toxin/docs/runs/oa10_toxicity_seq/papers/raw_extractions.csv`
- 一手实验记录（序列×数值）：`/root/private_data/aa_peptide/toxin/docs/runs/oa10_toxicity_seq/papers/raw_experimental_records.csv`
- 可复核表格：`/root/private_data/aa_peptide/toxin/docs/runs/oa10_toxicity_seq/papers/extracted_tables/`
- 监控报告：`/root/private_data/aa_peptide/toxin/docs/runs/oa10_toxicity_seq/papers/extraction_report.md`

**抽取到的数据量（来自论文表格/补充材料）**

- 论文数：10（XML 10/10；PDF 4/10；有补充材料的论文 3/10）
- `raw_experimental_records.csv`：149 行；唯一序列 27 条
- 端点分布：`IC50` 49、`CC50` 4、`HEMOLYSIS` 22、`MIC` 40、`MBC` 34  
  - 说明：`MIC/MBC` 属于“抗菌活性端点”（非严格意义的毒性端点）；若你后续只想收毒性（如 HEMOLYSIS/CC50/细胞毒性 IC50），可以在清洗阶段按 `endpoint` 过滤。

**示例（真实一手记录，可追溯到表格单元格）**

- DOI `10.1186/s13071-025-06861-5`：`CZS-1` 序列 `GFLDIVKGVGKVALGAVSKLF`，`CC50=386.4 µM`，定位 `table_id=Tab2;row_idx=1;col_idx=2;header_row_idx=0`
- DOI `10.1128/aac.00424-24`：`Lycosin-Ib` 序列 `RKGWFKAMKSIAKFIAKEKLKEHL`，`HEMOLYSIS=37%`（同一格还抽到浓度 `200 µM`），定位 `table_id=T2;row_idx=3;col_idx=5;header_row_idx=0`
- DOI `10.3390/ph18060862`：`PEP-38` 序列 `GLKDWVKKALGSLWKLANSQKAIISGKKS`，`IC50=13.25 μM`，定位 `table_id=pharmaceuticals-18-00862-t009;row_idx=1;col_idx=1;header_row_idx=0`

**未抽到“序列×数值”的论文（需要人工确认原因）**

以下 6 篇在本 pipeline 下得到 0 行实验记录，常见原因是：数值只在 figure 曲线里、或补充材料是 PDF/图片且无可解析表格、或端点不以表格呈现：

- `10.1038/s41598-025-06522-8`
- `10.3390/antibiotics14030312`
- `10.3390/toxins16100433`
- `10.1038/s41598-021-97821-3`
- `10.3389/fphar.2024.1443497`
- `10.1016/j.csbj.2024.09.006`

**本轮额外修复（影响抽取准确性）**

- 修复了“端点写在 Parameter 列”的表格：当数值列只有单位（如 `µM`）而端点在行属性（`Parameter=MIC/MBC/IC50`）时，自动用行端点覆盖弱表级提示，避免把 `MIC/MBC` 全误标成 `IC50`（对应脚本：`/root/private_data/aa_peptide/toxin/docs/scripts/extract_paper_extractions.py`）。
- 过滤了“比值/指数列”（例如 `SI (CC50/IC50)`）：避免把衍生指标误当作真实端点（例如误标成 `IC50`）。
